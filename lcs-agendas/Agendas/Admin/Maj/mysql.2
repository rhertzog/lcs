use agendas_plug;
CREATE TABLE webcal_access_function (cal_login VARCHAR(25) NOT NULL,cal_permissions VARCHAR(64) NOT NULL,PRIMARY KEY (cal_login));

ALTER TABLE webcal_nonuser_cals ADD cal_is_public CHAR(1) NOT NULL DEFAULT 'N';

CREATE TABLE webcal_user_template (cal_login VARCHAR(25) NOT NULL,cal_type CHAR(1) NOT NULL,cal_template_text TEXT,PRIMARY KEY (cal_login,cal_type));

ALTER TABLE webcal_entry_repeats ADD cal_endtime int(11) DEFAULT NULL;

ALTER TABLE webcal_entry_repeats ADD cal_bymonth varchar(50) DEFAULT NULL;

ALTER TABLE webcal_entry_repeats ADD cal_bymonthday varchar(100) DEFAULT NULL;

ALTER TABLE webcal_entry_repeats ADD cal_byday varchar(100) DEFAULT NULL;

ALTER TABLE webcal_entry_repeats ADD cal_bysetpos varchar(50) DEFAULT NULL;

ALTER TABLE webcal_entry_repeats ADD cal_byweekno varchar(50) DEFAULT NULL;

ALTER TABLE webcal_entry_repeats ADD cal_byyearday varchar(50) DEFAULT NULL;

ALTER TABLE webcal_entry_repeats ADD cal_wkst char(2) DEFAULT 'MO';

ALTER TABLE webcal_entry_repeats ADD cal_count int(11) DEFAULT NULL;

ALTER TABLE webcal_entry_repeats_not ADD cal_exdate int(1) NOT NULL DEFAULT '1';

ALTER TABLE webcal_entry ADD cal_due_date int(11) DEFAULT NULL;

ALTER TABLE webcal_entry ADD cal_due_time int(11) DEFAULT NULL;

ALTER TABLE webcal_entry ADD cal_location varchar(100) DEFAULT NULL;

ALTER TABLE webcal_entry ADD cal_url varchar(100) DEFAULT NULL;

ALTER TABLE webcal_entry ADD cal_completed int(11) DEFAULT NULL;

ALTER TABLE webcal_entry_user ADD cal_percent int(11) NOT NULL DEFAULT '0';

ALTER TABLE webcal_site_extras DROP PRIMARY KEY;

CREATE TABLE webcal_entry_categories (cal_id int(11) NOT NULL DEFAULT '0',cat_id int(11) NOT NULL DEFAULT '0',cat_order int(11) NOT NULL DEFAULT '0',cat_owner varchar(25) DEFAULT NULL);

CREATE TABLE webcal_blob (cal_blob_id INT NOT NULL,cal_id INT NULL,cal_login VARCHAR(25) NULL,cal_name VARCHAR(30) NULL,cal_description VARCHAR(128) NULL,cal_size INT NULL,cal_mime_type VARCHAR(50) NULL,cal_type CHAR(1) NOT NULL,cal_mod_date INT NOT NULL,cal_mod_time INT NOT NULL,cal_blob LONGBLOB,PRIMARY KEY ( cal_blob_id ));

DROP TABLE IF EXISTS webcal_access_user;

CREATE TABLE webcal_access_user (cal_login VARCHAR(25) NOT NULL,cal_other_user VARCHAR(25) NOT NULL,cal_can_view INT NOT NULL DEFAULT '0',cal_can_edit INT NOT NULL DEFAULT '0',cal_can_approve INT NOT NULL DEFAULT '0',cal_can_invite CHAR(1) DEFAULT 'Y',cal_can_email CHAR(1) DEFAULT 'Y',cal_see_time_only CHAR(1) DEFAULT 'N',PRIMARY KEY ( cal_login, cal_other_user ));

CREATE TABLE webcal_reminders (cal_id INT NOT NULL DEFAULT '0',cal_date INT NOT NULL DEFAULT '0',cal_offset INT NOT NULL DEFAULT '0',cal_related CHAR(1) NOT NULL DEFAULT 'S',cal_before CHAR(1) NOT NULL DEFAULT 'Y',cal_last_sent INT NOT NULL DEFAULT '0',cal_repeats INT NOT NULL DEFAULT '0',cal_duration INT NOT NULL DEFAULT '0',cal_times_sent INT NOT NULL DEFAULT '0',cal_action VARCHAR(12) NOT NULL DEFAULT 'EMAIL',PRIMARY KEY ( cal_id ));

ALTER TABLE webcal_nonuser_cals ADD cal_url VARCHAR(255) DEFAULT NULL;

ALTER TABLE webcal_categories ADD cat_color VARCHAR(8) DEFAULT NULL;

ALTER TABLE webcal_user ADD cal_enabled CHAR(1) DEFAULT 'Y';

ALTER TABLE webcal_user ADD cal_telephone VARCHAR(50) DEFAULT NULL;

ALTER TABLE webcal_user ADD cal_address VARCHAR(75) DEFAULT NULL;

ALTER TABLE webcal_user ADD cal_title VARCHAR(75) DEFAULT NULL;

ALTER TABLE webcal_user ADD cal_birthday INT NULL;

ALTER TABLE webcal_user ADD cal_last_login INT NULL;

CREATE TABLE webcal_timezones (tzid varchar(100) NOT NULL default '',dtstart varchar(25) default NULL,dtend varchar(25) default NULL,vtimezone text,PRIMARY KEY  ( tzid ));

