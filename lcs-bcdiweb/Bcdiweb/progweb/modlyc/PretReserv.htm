<!-- 17/11/2008 PretReserv.htm -->
<!-- Fichier PretsReserv.htm -->
<html>
<head>
<title>Réservations</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="<#CONST REP_IMAGES>style-bcdi3net.css" rel="stylesheet" type="text/css">
<SCRIPT type="text/javascript">
<!--
function init_liste_titres(valeur) // renvoie le formulaire avec la liste correspondant au début de saisie
{
  var nom="NOTICES_NOTICE="; // ce qui sera dans le query de l'URL
  var ch=window.location.href;
  var p=ch.indexOf(nom);
//  if ( touche!=null && touche!=0 && touche!=8 && touche!=9 && touche!=13 && touche!=27 )
  {
  if (p>0)
    ch=ch.substring(0,p-1) // on enlève l'éventuel F2 précédent
  if (ch.indexOf("MODELE")<0)
    {
    if (ch.indexOf("?")>0)
      ch+='&'
    else
      ch+='?'
    ch+="MODELE=PRETRESERV"
    }
  if (ch.indexOf("CONNECTION")<0)
    ch+="&CONNECTION=<#CONNECTION>"
  if (ch.indexOf("FAIRE")<0)
	ch+="&FAIRE=CHOISIR_NOTICE"
  if (ch.indexOf("TARGET")<0)
    ch+="&TARGET='_self'"
  if (valeur>"")
    {
    if (valeur.charAt(valeur.length-1)!=" ")
      ch+="&"+nom+valeur;
    }
  window.location.href=ch;
  }
}
function decode(ch)
{
  st="";
  p=0;
  while (p<ch.length)
  {
    c=ch.charAt(p++);
    if ((c=="%") && (ch.charAt(p)=="2") && ((ch.charAt(p+1)=="2") || (ch.charAt(p+1)=="7")))
    {
      p++;
      if (ch.charAt(p)=="2")
        c='"'
      else
        c="'"
      p++;
    }
    st+=c;
  }
  return st
}
function maj_saisie_titre() // recopie la valeur de la liste déroulante dans la zone de saisie
{
  var suite="+++";
  ch=document.forms[0].LISTE_TITRES.value;
  if (ch.indexOf(suite)==0)
    init_liste_titres(ch.substr(suite.length,255))
  else
    document.forms[0].NOTICES_NOTICE.value=decode(ch)
}
-->
</script>
</head>
<body onload="document.FORMULAIRE_RESERVATIONS.NOTICES_NOTICE.focus()">
<b><BR><font size="5">Compte lecteur : <#UTILISATEUR></font></b><BR>
Nombre de prêts au total  : <#NB_PRETS> <br>
Nombre de prêts en retard : <#NB_PRETS_EN_RETARD><br>
Nombre de prêts en cours  : <#NB_PRETS_EN_COURS> <br><br>
Nombre de réservations    : <#NB_RESERVATIONS><br>
Liste des r&eacute;servations : <br>
<#LISTE_RESERVATIONS FICHE_RESERVATION> <br><Br>
<b><font size="5">Réservation en ligne<BR></font></b>

<FORM name="FORMULAIRE_RESERVATIONS" action="<#URLDLL>" method=post TARGET="_self">
<INPUT type="hidden" name="CONNECTION" value="<#CONNECTION>">
<input type="hidden" name="FICHIER" value="PretReserv">
<input type="hidden" name="FAIRE" value="VOIR_DISPONIBILITE">
<input type="hidden" name="MODELE" value="FICHEDISPO">
<table>
<TR><TD><i>Tapez les premières lettres du titre recherché, capturez-le dans la liste, puis cliquez sur le bouton 'Voir la disponibilité'</i></TD></TR>
<TR><TD>
	<input type="text" name="NOTICES_NOTICE" value="<#NOTICES_NOTICE>" largeur="100"" onKeyUp="init_liste_titres(document.forms[0].NOTICES_NOTICE.value)"
           ONFOCUS="if (this.createTextRange) {
           var range = this.createTextRange();
           range.collapse(false);
           range.select();
           }" class="txt18x600">

   </td>
</tr>
<tr>
            <td align="center">
				<select name="LISTE_TITRES" value="Liste Titres" onChange="maj_saisie_titre()" size="7" class="select600"><#LISTE NOTICES NOTICE>
                </select>
           </td>
           </tr>
  <tr>
    <td>
    <TABLE align="center"><TR>
      <TD><input type="image" src="<#CONST REP_IMAGES>bout-lancer.gif" alt="Voir la disponibilité" align="top" title="Voir la disponibilité"></TD>
<SCRIPT type="text/javascript">
<!--
  if (history.length>0)
  document.write("<TD><a href='javascript:history.back();'><img src='<#CONST REP_IMAGES>Bout-Retour.bmp' alt='Revenir'></a></TD>");
-->
</SCRIPT>
      <TD><a href="javascript:window.close()"><img src="<#CONST REP_IMAGES>bout-close.gif" alt="Revenir à l'écran d'accueil" align="right"></a></TD>
      </TR></TABLE>
    </td>
  </tr>
</table>
</FORM>
</body>
</html>
