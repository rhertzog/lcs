<!-- Fichier Cherche.htm  11/01/2012 -->
<#SI RECHERCHE=THEME><#VAR EXTENSION=PLUS><#SINON RECHERCHE=THEME><#SI RECHERCHE=THESAURUS><#VAR EXTENSION=PLUS><#SINON RECHERCHE=THESAURUS><#VAR EXTENSION=MOINS><#FINSI RECHERCHE=THESAURUS><#FINSI RECHERCHE=THEME>
<#SI RECHERCHE=THESAURUS>
<#VAR EVENEMENT=onkeyup="fKeyUp(event,this.name)" onFocus="surFocus(this)">
<#SINON RECHERCHE=THESAURUS>
<#VAR EVENEMENT="">
<#VAR AVEC_COMPARAISON=OUI>
<#FINSI RECHERCHE=THESAURUS>
<script language="JavaScript">
function DonnerFocus(nom)
{
  if (document.getElementsByName(nom).length==1)
  if (document.getElementsByName(nom)[0].type=="text")
	document.getElementsByName(nom)[0].focus();
}

  <#SI RECHERCHE=TITRE>
var premierChamp=""
var aBalFic_Chp=new Array("<#NOTICES_TITRE>")
var aFic_Chp=new Array('NOTICES_TITRE')
aChp=new Array('titre')
  <#SINON RECHERCHE=TITRE>
	<#SI RECHERCHE=AUTEUR>
var aBalFic_Chp=new Array("<#AUTEURS_AUTEUR>")
var aFic_Chp=new Array('AUTEURS_AUTEUR')
aChp=new Array('auteur')
	<#SINON RECHERCHE=AUTEUR>
	  <#SI RECHERCHE=COLLECTION>
<#VAR AVEC_COMPARAISON=NON>
var aBalFic_Chp=new Array("<#COLLECTIONS_COLLECTION>")
var aFic_Chp=new Array('COLLECTIONS_COLLECTION')
aChp=new Array('collection')
	  <#SINON RECHERCHE=COLLECTION>
	  <#SI RECHERCHE=EDITEUR>
<#VAR AVEC_COMPARAISON=NON>
var aBalFic_Chp=new Array("<#EDITEURS_EDITEUR>")
var aFic_Chp=new Array('EDITEURS_EDITEUR')
aChp=new Array('editeur')
	  <#SINON RECHERCHE=EDITEUR> // THESAURUS
var delai_de_frappe=3000 // millisecondes
var DernierCode=0 // pour fKeyUp
var en_timer=false
var chpAlister=""
var idTimer=""
var nomChpFocus=""

function ParDefaut(ch,defaut)
{
  while (ch.substring(0,1)==" ")
  {
   ch=ch.substring(1,ch.length)
  }
  if (ch=="")
   ch=defaut
  return ch
}

function RajouterParametre(url,nom,valeur)  // on rajoute un champ de la liste des paramètres d'une URL
{
  rajout=nom+"="+escape(valeur);
  nom=nom.toUpperCase();
  urlUp=url.toUpperCase()+"&";
  p=urlUp.indexOf("?"+nom+"=");
  if (p<0) p=urlUp.indexOf("&"+nom+"=");
  if (p<0) {
	p=url.indexOf("?");
	if (p<0) url+="?"; else url+="&";
	url+=rajout;
  }
  else
  {
	p+=1
	q=urlUp.indexOf("&",p);
	url=url.substr(0,p)+rajout+url.substr(q)
  }
  return(url)
}

function fKeyUp(event,nom)
{
  chpAlister=nom
  if (en_timer) window.clearTimeout(idTimer)
  idTimer=window.setTimeout("init_liste()",delai_de_frappe)
  en_timer=true
  if (!event)
  if (window.event) event=window.event
  if (event)
  {
	 if (typeof(event.keyCode)=="number")
	  DernierCode=event.keyCode;
	 else if (typeof(event.which)=="number")
	  DernierCode=event.which;
	 else if (typeof(event.charCode)=="number")
	  DernierCode=event.charCode;
  }
}

function valeurs_checkees(NomChp)
{
  res=""
  ListeElements=document.getElementsByName(NomChp)
  if (ListeElements.length>0)
  {
	for(var j=0; j<ListeElements.length; j++)
	{
	  if (ListeElements[j].checked)
	  {
		if (res>" ")
		  res+="|"
		res+=ListeElements[j].value
	  }
	}
  }
  return(res)
}

/*
function init_liste(chp)  // renvoie le formulaire avec la liste correspondant au début de saisie
{
  if (en_timer) window.clearTimeout(idTimer)
  en_timer=false
  ch=window.location.href;
  for (i=0;i<document.forms[0].elements.length;i++) {
	obj=document.forms[0].elements[i]
	nom=obj.name
	upNom=nom.toUpperCase()
	if (upNom.substr(0,5)=="THEME")
	{
	  ch=RajouterParametre(ch,upNom,obj.value)
	  if (nomChpFocus==nom) ch=RajouterParametre(ch,"THESAURUS_DESCRIPTEURS",obj.value)
	}
  }
//  ch=RajouterParametre(ch,"CLASSEMENT",valeurs_checkees("CLASSEMENT"))
  ch=RajouterParametre(ch,"SUPPORT1",valeurs_checkees("SUPPORT1"))
  ch=RajouterParametre(ch,"TYPEDENATURE",valeurs_checkees("TYPEDENATURE"))
  ch=RajouterParametre(ch,"DISPO",valeurs_checkees("DISPONIBILITE"))
  ch=RajouterParametre(ch,"AUTOPOSTAGE",valeurs_checkees("AUTOPOSTAGE"))
  ch=RajouterParametre(ch,"FOCUS",chpAlister)
//  if (nomChpFocus>"") ch=RajouterParametre(ch,"FOCUS",nomChpFocus)
//  ch=RajouterParametre(ch,"FICHIER",document.forms[0].FICHIER.value)
//  ch=RajouterParametre(ch,"NP",document.forms[0].NP.value)
//alert(ch);
  window.location.href=ch;
}
*/
function decode(ch)
{
  st="";
  p=0;
  while (p<ch.length)
  {
	c=ch.charAt(p++);
	if ((c=="%") && (ch.charAt(p)=="2") && ((ch.charAt(p+1)=="2") || (ch.charAt(p+1)=="7")))
    {
	  p++;
      if (ch.charAt(p)=="2")
		c='"'
      else
		c="'"
      p++;
    }
    st+=c;
  }
  return(st)
}

function maj_saisie() // recopie la valeur de la liste déroulante dans la zone de saisie
{
  var suite="+++";
  pour=document.getElementById(nomChpFocus)
  if(pour!=null) pour.focus();
  ch=document.forms[0].LISTE_DESCRIPTEURS.value
  if (ch.indexOf(suite)==0)
  {
	ch=ch.substr(suite.length,255)
	if(pour!=null) pour.value=decode(ch)
    if (nomChpFocus!="") chpAlister=nomChpFocus
    init_liste()
  }
  else document.getElementById(nomChpFocus).value=decode(ch)
}
function surFocus(obj)
{
  nomChpFocus=obj.name
  if (obj.createTextRange)
  {
	var range = obj.createTextRange();
	range.collapse(false);range.select();
  }
}
	  <#FINSI RECHERCHE=EDITEUR>
	  <#FINSI RECHERCHE=COLLECTION>
	<#FINSI RECHERCHE=AUTEUR>
  <#FINSI RECHERCHE=TITRE>
function elargir(dico)
{
  avecAutopostage=(document.getElementsByName("AUTOPOSTAGE").length>0);
  if (document.getElementsByName("LANGAGE").length>0)
  if (dico)
	document.getElementsByName("LANGAGE")[0].value="DICO"
  else {
	document.getElementsByName("LANGAGE")[0].value="TEXTESEUL"
	if (avecAutopostage) document.forms[0].AUTOPOSTAGE.checked=false;
  }
  if (avecAutopostage) document.forms[0].AUTOPOSTAGE.disabled=!dico;
}
function majNom2()
{
  if (etOu)
  {
	document.getElementById("THEMEPOLE1CASE2").value=document.getElementById("THEMEPOLE2").value;
	document.getElementById("THEMEPOLE2CASE1").value="";
  }
  else
  {
	document.getElementById("THEMEPOLE2CASE1").value=document.getElementById("THEMEPOLE2").value;
	document.getElementById("THEMEPOLE1CASE2").value="";
  }
}
function changeEtOu() {
  etOu=(document.getElementById("CONJONCTION_OU").checked)
  majNom2()
}

function affecterComment() { // Si que THEMEPOLE1CASE1 est rempli, recherche exacte
<#SI CONFIGURATION=SIMPLE>
  if (document.getElementById("THEMEPOLE2").value<"!") {
	document.getElementById("COMMENT").value="EXACT";
	document.getElementById("QUOI").value=document.getElementById("THEMEPOLE1CASE1").value;
  }
<#FINSI CONFIGURATION=SIMPLE>
}
</script>
<INPUT TYPE="HIDDEN" NAME="NP" VALUE="<#VALEUR NUMERO_PANIER>"/>
<INPUT TYPE="HIDDEN" NAME="FICHIERORIGINE" VALUE="<#FICHIER>"/>
<INPUT TYPE="HIDDEN" NAME="RESTRICTIONS" VALUE="OUI"/>
<INPUT TYPE="HIDDEN" NAME="FORMAT" VALUE="LISTENOT"/>
<INPUT TYPE="HIDDEN" NAME="FOCUS" VALUE="<#FOCUS>"/>
<#SI EXTENSION#PLUS>
  <#SI RECHERCHE=TITRE>
	<input type="HIDDEN" id="TITRE" name="TITRE" value="<#NOTICES_TITRE>"/>
	<input type="HIDDEN" name="COMPARE_TITRE" value="<#COMPARE_TITRE>"/>
	<input type="HIDDEN" name="LANGAGE" value="TEXTESEUL"/>
  <#SINON RECHERCHE=TITRE>
	<#SI RECHERCHE=AUTEUR>
	  <input type="HIDDEN" id="AUTEUR" name="AUTEUR" value="<#AUTEURS_AUTEUR>"/>
	  <input type="HIDDEN" name="COMPARE_AUTEUR" value="<#COMPARE_AUTEUR>"/>
	  <input type="HIDDEN" name="LANGAGE" value="TEXTESEUL"/>
	<#SINON RECHERCHE=AUTEUR>
	  <#SI RECHERCHE=COLLECTION>
		<input type="HIDDEN" id="COLLECTION" name="COLLECTION" value="<#COLLECTIONS_COLLECTION>"/>
		<input type="HIDDEN" name="COMPARE_COLLECTION" value="<#COMPARE_COLLECTION>"/>
	  <#SINON RECHERCHE=COLLECTION>
		<#SI RECHERCHE=EDITEUR>
		  <input type="HIDDEN" id="EDITEUR" name="EDITEUR" value="<#EDITEURS_EDITEUR>"/>
		  <input type="HIDDEN" name="COMPARE_EDITEUR" value="<#COMPARE_EDITEUR>"/>
		  <input type="HIDDEN" name="LANGAGE" value="TEXTESEUL"/>
		<#SINON RECHERCHE=EDITEUR>
		  <INPUT TYPE="HIDDEN" NAME="LANGAGE" VALUE="<#SI RECHERCHE=THESAURUS>THESAURUS<#SINON RECHERCHE=THESAURUS>INDEFINI<#FINSI RECHERCHE=THESAURUS>"/>
		<#FINSI RECHERCHE=EDITEUR>
	  <#FINSI RECHERCHE=COLLECTION>
	<#FINSI RECHERCHE=AUTEUR>
  <#FINSI RECHERCHE=TITRE>

<SCRIPT type="text/javascript">
function decode(ch)
{
  st="";
  p=0;
  while (p<ch.length)
  {
	c=ch.charAt(p++);
	if ((c=="%") && (ch.charAt(p)=="2") && ((ch.charAt(p+1)=="2") || (ch.charAt(p+1)=="7")))
	{
	  p++;
	  if (ch.charAt(p)=="2")
		c='"'
	  else
		c="'"
	  p++;
	}
	st+=c;
  }
  return(st)
}

function maj_saisie(Fic_Chp,objet,pour) // recopie la valeur de la liste déroulante dans la zone de saisie
{
  var suite="+++";
  DonnerFocus(pour.name)
  ch=objet.value;
  if (ch.indexOf(suite)==0)
  {
	ch=ch.substr(suite.length,255)
	pour.value=decode(ch)
	affecterHidden(pour);
	chpAlister=pour.name
	init_liste()
  }
  else {
	pour.value=decode(ch);
	affecterHidden(pour);
  }
}
function EnteteListe()
{
  ChpUp=aChp[no]
  ChpPluriel=ChpUp+'s'
  ChpUp=ChpUp.toUpperCase()
  document.write('<div class="ListeF2" ID="LISTE_POUR_'+ChpUp+'">')
  document.write('<div class="tridroitetitre">Liste des '+ChpPluriel+'</div>')
  document.write('<select name="LISTE_'+ChpUp+'" value="Liste '+ChpPluriel+'" onChange="maj_saisie(')
//  document.write("'"+escapeApostrophe(aFic_Chp[no])+"',this,document.forms[0]."+ChpUp+")")
  document.write("'"+aFic_Chp[no]+"',this,document.forms[0].A_"+ChpUp+")")
  document.write('" size="7" class="select600">')
  no++;
}

function BasListe()
{
document.write('<\/select><\/div>')
}
no=0; EnteteListe();
</SCRIPT>
  <#SI RECHERCHE=TITRE>
	<#LISTE NOTICES TITRE LARGEUR=60>
  <#SINON RECHERCHE=TITRE>
	<#SI RECHERCHE=AUTEUR>
	  <#LISTE AUTEURS AUTEUR LARGEUR=60>
	<#SINON RECHERCHE=AUTEUR>
	 <#SI RECHERCHE=COLLECTION>
	  <#LISTE COLLECTIONS COLLECTION LARGEUR=60>
	 <#SINON RECHERCHE=COLLECTION>
	  <#LISTE EDITEURS EDITEUR LARGEUR=60>
	 <#FINSI RECHERCHE=COLLECTION>
	<#FINSI RECHERCHE=AUTEUR>
  <#FINSI RECHERCHE=TITRE>
<SCRIPT type="text/javascript">BasListe();</SCRIPT>
<#SINON EXTENSION#PLUS>
<#SI RECHERCHE=THESAURUS>  <INPUT TYPE="HIDDEN" NAME="LANGAGE" VALUE="THESAURUS"/><#FINSI RECHERCHE=THESAURUS>
<#FINSI EXTENSION#PLUS>
<SCRIPT type="text/javascript">if (!ie) document.write('<br/>'); </SCRIPT>
<div style="background-color:<#VAR COULTHEME>; border:1px solid #000000; font-family:Times New Roman">
	<br/>&nbsp;
 <#SI EXTENSION=PLUS>
<table><tr>
  <#SI RECHERCHE=THEME>
	<td width="120" align="right" valign="top"><b>Je cherche des </b></td>
	<td width=4>&nbsp;</td>
	<td width=300><input name="TYPEDENATURE" type="checkbox" value="Fiction" checked />Fictions <i><b><span style="font-size:12px">(des histoires racontées, inventées...)</b></i></span></td>
	<td width=20>&nbsp;</td>
	<td><input name="TYPEDENATURE" type="checkbox" value="Documentaire" checked="Yes"/>Documentaires <i><b><span style="font-size:12px">(des informations...)</span></b></i></td>
  </tr><tr>
	<td align="right" valign="top">
	  <br/><b> parlant de </b><br/>
  <#SINON RECHERCHE=THEME>
	<td align="right" valign="top">
	  <b> Je cherche </b><br/>
  <#FINSI RECHERCHE=THEME>
<#SI CONFIGURATION=SIMPLE>
	<span style="font-size: 8px;">&nbsp;</span><br/>
	<input type="HIDDEN" id="THEMEPOLE1CASE2" name="THEMEPOLE1CASE2"/>
	<input type="HIDDEN" id="THEMEPOLE2CASE1" name="THEMEPOLE2CASE1"/>
	<input type="HIDDEN" id="COMMENT" name="COMMENT" value="TOUS"/>
	<input type="HIDDEN" id="QUOI" name="QUOI" value=""/>
	<span style="font-size:8px"><br/></span><br>
	<span style="font-size:12px">Et</span>
	<input id="CONJONCTION_ET" name="CONJONCTION" type="radio" value="ET" onClick="changeEtOu()" checked />
	<span style="font-size:12px">&nbsp;&nbsp;ou</span>
	<input id="CONJONCTION_OU" name="CONJONCTION" type="radio" value="OU" onClick="changeEtOu()" checked />
	<span style="font-size:14px"><b>&nbsp;&nbsp;&nbsp;&nbsp;de</b></span>
<#SINON CONFIGURATION=SIMPLE>
<br/><b> et <br/>&nbsp;
<br/> et <br/>&nbsp;
<br/> sauf </b><br/>&nbsp;
<#FINSI CONFIGURATION=SIMPLE>
  </td>
  <td>&nbsp;</td>
  <td valign="top"><#SI RECHERCHE=THEME><br/><#FINSI RECHERCHE=THEME>
	<input id="THEMEPOLE1CASE1" name="THEMEPOLE1CASE1" value="<#THEMEPOLE1CASE1>" class="input200" <#VAR EVENEMENT> />
<#SI CONFIGURATION=SIMPLE>
	<span style="font-size:12px"><br><i>(par exemple : Egypte, eau douce...)</i></span>
	<br />&nbsp;<br/>
	<input id="THEMEPOLE2" name="THEMEPOLE2" value="<#THEMEPOLE2>" class="input200" onkeyup="majNom2()"/>
	<span style="font-size:12px"><br><i>(par exemple : religion, pollution...)</i></span>
<#SINON CONFIGURATION=SIMPLE>
	  <br/>&nbsp;<br/>
	  <input id="THEMEPOLE2CASE1" name="THEMEPOLE2CASE1" value="<#THEMEPOLE2CASE1>" type="text" class="input200" <#VAR EVENEMENT> />
	  <br/>&nbsp;<br/>
	  <input id="THEMEPOLE3CASE1" name="THEMEPOLE3CASE1" value="<#THEMEPOLE3CASE1>" type="text" class="input200" <#VAR EVENEMENT> />
	  <br/>&nbsp;<br/>
	  <input id="THEMESAUFCASE1" name="THEMESAUFCASE1" value="<#THEMESAUFCASE1>" type="text" class="input200" <#VAR EVENEMENT> />
	  &nbsp;
	</td><td valign="top"><#SI RECHERCHE=THEME><br/><#FINSI RECHERCHE=THEME>
	  <span><b>ou</b>&nbsp;</span>
	  <br/>&nbsp;<br/>
	  <span><b>ou</b>&nbsp;</span>
	  <br/>&nbsp;<br/>
	  <span><b>ou</b>&nbsp;</span>
	</td><td valign="top"><#SI RECHERCHE=THEME><br/><#FINSI RECHERCHE=THEME>
	  <span>
		<input id="THEMEPOLE1CASE2" name="THEMEPOLE1CASE2" value="<#THEMEPOLE1CASE2>" type="text" class="input200" <#VAR EVENEMENT> />
	  </span>
	  <br/>&nbsp;<br/>
	  <span>
		<input id="THEMEPOLE2CASE2" name="THEMEPOLE2CASE2" value="<#THEMEPOLE2CASE2>" type="text" class="input200" <#VAR EVENEMENT> />
	  </span>
	  <br/>&nbsp;<br/>
	  <span>
		<input id="THEMEPOLE3CASE2" name="THEMEPOLE3CASE2" value="<#THEMEPOLE3CASE2>" type="text" class="input200" <#VAR EVENEMENT> />
		&nbsp;
	  </span>

<#FINSI CONFIGURATION=SIMPLE>
  </td>
<#SI RECHERCHE=THESAURUS>
  </tr><tr>
		<td><b>Elargir aux </b></td>
		<td colspan=4 style="font-size: 12px;">
		<input name="AUTOPOSTAGE" type="radio" value="SPECIFIQUE"/> Termes spécifiques&nbsp;&nbsp;
		<input name="AUTOPOSTAGE" type="radio" value="GENERIQUE"/> Termes génériques&nbsp;&nbsp;
		<input name="AUTOPOSTAGE" type="radio" value="ASSOCIE"/> Termes associés&nbsp;&nbsp;
		<input name="AUTOPOSTAGE" type="radio" value="" checked /> Aucun
		</td>
</tr></table>
	  <div class="ListeF2Th" ID="LISTE_POUR_DESCRIPTEUR">
		<div class="tridroitetitre">Liste des descripteurs</div>
		<select name="LISTE_DESCRIPTEURS" value="Liste descripteurs" onChange="maj_saisie()" size="7" class="select600">
		  <#LISTE THESAURUS DESCRIPTEURS LARGEUR=60>
		</select>
	  </div>
  <SCRIPT type="text/javascript">DonnerFocus("<#FOCUS>");</script></#si>
<#SINON RECHERCHE=THESAURUS>
</tr>
  <#SI LOGICIEL=BCDIECOLE>
  </table><br>
	<INPUT TYPE="HIDDEN" NAME="LANGAGEVISIBLE" VALUE="DICO"/>
  <#SINON LOGICIEL=BCDIECOLE>
   <tr>
  <td>&nbsp;</td><td>&nbsp;</td>
  <td>	<INPUT  name ="LANGAGEVISIBLE" type="radio" value="DICO" onclick="elargir(true)" checked /> Avec le dictionnaire&nbsp;
	<i><b><span style="font-size:12px">(mots équivalents)</b></i></span><br/>
	<INPUT  name ="LANGAGEVISIBLE"type="radio" value="TEXTESEUL" onclick="elargir(false)"/>Sans le dictionnaire<br>&nbsp;
  </td>
  <td>&nbsp;</td>
	<td valign="top">
<!--	<INPUT  type="Checkbox" name="AUTOPOSTAGE" value="SPECIFIQUE"/>&nbsp;Elargir la recherche
	<span style="font-size:12px"><i><b>(chercher des thèmes proches)</b></i></span>
  C'est fait en résultat de recherche
-->
	&nbsp;</td>
  </tr>
  </table>
  <#FINSI LOGICIEL=BCDIECOLE>
	<INPUT  type="HIDDEN" name="AUTOPOSTAGE" value=""/>
<#FINSI RECHERCHE=THESAURUS>

<#SINON EXTENSION=PLUS>
<SCRIPT type="text/javascript">
var en_compare=false
var Derouler=false // A priori, on ne déroule pas les restrictions.
var DernierCode=0 // pour fKeyUp
var en_timer=false
var chpAlister=""
var idTimer=""

var ApresRadio=false
function escapeApostrophe(ch)
{
  escapeApostrophe=''
  for (var i=0; i<ch.length; i++) {
	c=ch.charAt(i)
	if (c="'") escapeApostrophe+="\\"
	escapeApostrophe+=c
  }
}
var delai_de_frappe=3000 // millisecondes

function RajouterParametre(url,nom,valeur)  // on rajoute un champ de la liste des paramètres d'une URL
{
  rajout=nom+"="+escape(valeur);
  nom=nom.toUpperCase();
  urlUp=url.toUpperCase()+"&";
  p=urlUp.indexOf("?"+nom+"=");
  if (p<0) p=urlUp.indexOf("&"+nom+"=");
  if (p<0) {
	p=url.indexOf("?");
	if (p<0) url+="?"; else url+="&";
	url+=rajout;
  }
  else
  {
	p+=1
	q=urlUp.indexOf("&",p);
	url=url.substr(0,p)+rajout+url.substr(q)
  }
  return(url)
}

function valeurs_checkees(NomChp)
{
  res=""
  ListeElements=document.getElementsByName(NomChp)
  if (ListeElements.length>0)
  {
	for(var j=0; j<ListeElements.length; j++)
	{
	  if (ListeElements[j].checked)
	  {
		if (res>" ")
		  res+="|"
		res+=ListeElements[j].value
	  }
	}
  }
  return(res)
}
function valeurChamp(nomChp) {
  le=document.getElementsByName(nomChp);
  if (le.length>0) res=le[0].value; else res="not exist";
  return(res);
}
function init_liste()  // renvoie le formulaire avec la liste correspondant au début de saisie
{
//if (DernierCode!=39 && DernierCode!=37 && DernierCode!=32 && DernierCode!=9 && DernierCode!=16 && DernierCode!=17) // flêche droite
  {
  if (en_timer) window.clearTimeout(idTimer)
  en_timer=false
  vc=valeurs_checkees("COMPARE_"+chpAlister)
  if ((en_compare && (vc=="CONTIENT")) || (!en_compare && (vc!="CONTIENT")))
  {
	if (en_compare)
	{
	  if (vc=="CONTIENT")
		vc="COMMENCE"
	  else
		vc="CONTIENT"
	}
	ch=window.location.href;
	for(var n=0; n<aFic_Chp.length; n++)
	{
	  chpn=aChp[n].toUpperCase()
	  ch=RajouterParametre(ch,chpn,document.forms[0].elements[chpn].value)
	  ch=RajouterParametre(ch,aFic_Chp[n],document.forms[0].elements[chpn].value)
/*
	  if (chpAlister==chpn)
	  {
		ch=RajouterParametre(ch,"COMPARE_"+chpn,vc)
	  }
	  else
*/
		ch=RajouterParametre(ch,"COMPARE_"+chpn,valeurChamp("COMPARE_"+chpn))
	}
//	ch=RajouterParametre(ch,"QUOI",document.forms[0].QUOI.value)
	ch=RajouterParametre(ch,"COMMENT",valeurs_checkees("COMMENT"))
	ch=RajouterParametre(ch,"TYPEDENATURE",valeurs_checkees("TYPEDENATURE"))
	ch=RajouterParametre(ch,"SUPPORT1",valeurs_checkees("SUPPORT1"))
	ch=RajouterParametre(ch,"DATEEGAL",valeurChamp("DATEEGAL"))
	ch=RajouterParametre(ch,"DATEINF",valeurChamp("DATEINF"))
	ch=RajouterParametre(ch,"DATESUP",valeurChamp("DATEINF"))
	ch=RajouterParametre(ch,"NATURES",valeurs_checkees("NATURES"))
	ch=RajouterParametre(ch,"GENRES",valeurs_checkees("GENRES"))
	ch=RajouterParametre(ch,"PUBLICS",valeurs_checkees("PUBLICS"))
	ch=RajouterParametre(ch,"NIVEAUX",valeurs_checkees("NIVEAUX"))
	ch=RajouterParametre(ch,"DISCIPLINES",valeurs_checkees("DISCIPLINES"))
	ch=RajouterParametre(ch,"DISPO",valeurs_checkees("DISPONIBILITE"))
	ch=RajouterParametre(ch,"FOCUS",chpAlister)
	ch=RajouterParametre(ch,"FICHIER",valeurChamp("FICHIER"))
	ch=RajouterParametre(ch,"NP",valeurChamp("NP"))
<#SI RECHERCHE=COLLECTION>
	ch=RajouterParametre(ch,"THEMEPOLE1CASE1",valeurChamp("THEMEPOLE1CASE1"))
	ch=RajouterParametre(ch,"THEMEPOLE1CASE2",valeurChamp("THEMEPOLE1CASE2"))
	ch=RajouterParametre(ch,"THEMEPOLE2",valeurChamp("THEMEPOLE2"))
<#FINSI RECHERCHE=COLLECTION>
	window.location.href=ch;
  }
}
}
function fKeyUp(event,nom)
{
  chpAlister=nom.substr(2)
  if (en_timer) window.clearTimeout(idTimer)
  idTimer=window.setTimeout("init_liste()",delai_de_frappe)
  en_timer=true
  if (!event)
  if (window.event) event=window.event
  if (event)
  {
	 if (typeof(event.keyCode)=="number")
	  DernierCode=event.keyCode;
	 else if (typeof(event.which)=="number")
	  DernierCode=event.which;
	 else if (typeof(event.charCode)=="number")
	  DernierCode=event.charCode;
  }
}

function MontreListe(objet)
{
  NomObj=objet.name
  ParRadio=(NomObj.indexOf("COMPARE_")>=0)
  if (ParRadio) {
	NomObj=NomObj.substr(8);
  }
//  else
  {
	if (NomObj.charAt(1)=="_") NomObj=NomObj.substr(2)
	LesDiv=document.getElementsByTagName("div")
	for(var i=0; i<LesDiv.length; i++)
	{
	  chId=LesDiv[i].id
	  if (chId.indexOf("LISTE_POUR")>=0)
	  {

		montrer=true
		if ((chId.indexOf(NomObj)>=0) && (objet.value=="CONTIENT"))
		  montrer=false
		else
		{
		  NomChp="COMPARE_"+chId.substr(11)
		  Radios=document.getElementsByName(NomChp)
		  if (Radios.length>0)
		  {
			for(var j=0; j<Radios.length; j++)
			{
			if (((Radios[j].value=="CONTIENT") && ((Radios[j].checked) && !(ApresRadio))) || ((Radios[j].value=="COMMENCE") && ((Radios[j].checked) && ApresRadio)))
			  montrer=false
			}
		  }
		}
		if ((chId.indexOf(NomObj)>=0) && montrer)
		  LesDiv[i].style.visibility="visible"
		else
		  LesDiv[i].style.visibility="hidden"
	  }
	}
  }
  document.getElementsByName("FOCUS")[0].value=NomObj
  ApresRadio=ParRadio
}

function maj_compare(objet)
{
  if (objet.value=="CONTIENT")
	MontreListe(objet)
  else
  {
	chpAlister=objet.name.substr(8)
	en_compare=true
	init_liste()
	en_compare=false
  }
}

function affecterHidden(obj) // et effacer l'autre champ
{

  nom=obj.name;
  nomChamp=nom.substr(2);
  document.getElementsByName(nomChamp)[0].value=obj.value;
  c=nom.charAt(0);
  if (c=="A") {
	c="B";
	comp="COMMENCE"
  }
  else {
	c="A";
	comp="CONTIENT"
  }
  nom=c+nom.substr(1);
<#SI AVEC_COMPARAISON=OUI>
  if (obj.value>"") document.getElementsByName(nom)[0].value="";
<#FINSI AVEC_COMPARAISON=OUI>
  document.getElementsByName("COMPARE_"+nomChamp)[0].value=comp
  maj_compare(document.getElementsByName("COMPARE_"+nomChamp)[0])
}

document.write('<table width=480>');
for(var n=0; n<aFic_Chp.length; n++)
{
  Fic_Chp=aFic_Chp[n]
  NomChp=aChp[n]
  NomChpUp=NomChp.toUpperCase()
  compare=document.getElementsByName("COMPARE_"+NomChpUp)[0].value;
  if (compare=="COMMENCE") compare="A_"; else compare="B_"
  document.write('<tr>');
  document.write('<td colspan=3>');

 if (n>0) document.write('<br/>&nbsp;');
   document.write('<b>&nbsp;&nbsp;&nbsp;Je cherche un')
<#SI RECHERCHE=COLLECTION> document.write('e'); <#FINSI RECHERCHE=COLLECTION>
	   document.write(' '+NomChp+'</b>')
		 document.write('</td></tr><tr>')

	document.write('<td width=160 align=right>Commençant par ');
<#SI RECHERCHE=COLLECTION> document.write('<br/><br/><br/><br/><br/>'); <#FINSI RECHERCHE=COLLECTION>
  <#SI AVEC_COMPARAISON=OUI> document.write('<br/>&nbsp;<b>ou</b> <br/>contenant le(s) mot(s)<br/>&nbsp;');<#FINSI AVEC_COMPARAISON=OUI>

  document.write('</td><td>&nbsp;&nbsp;</td><td  valign="top">');
  if (compare=="A_") val=aBalFic_Chp[n]; else val="";
  document.write('<input width=100% type="text" id="A_'+NomChpUp+'" name="A_'+NomChpUp+'" value="'+val+'" onkeyup="affecterHidden(this);fKeyUp(event,this.name);"')
  document.write(' ONFOCUS="MontreListe(this); if (this.createTextRange) {var range = this.createTextRange();')
  document.write('range.collapse(false);range.select();}" class="input200"/>');
  <#SI AVEC_COMPARAISON=OUI>
	if (compare=="B_") val=aBalFic_Chp[n]; else val="";
	<#SI RECHERCHE=TITRE>
	document.write('<br/><span style="font-size:12px"><i>(par exemple : LES AVENTURES DE puis patienter)</i></span><br/><input width=200 type="text" id="B_'+NomChpUp+'" name="B_'+NomChpUp+'" value="'+val+'" onkeyup="affecterHidden(this);" class="input200"/>');
	document.write('<br/><span style="font-size:12px"><i>(par exemple : Tintin)</i></span><br/>');
	<#FINSI RECHERCHE=TITRE>
	<#SI RECHERCHE=AUTEUR>
	document.write('<br/><span style="font-size:12px"><i>(par exemple : Hugo)</i></span><br/><input width=200 type="text" id="B_'+NomChpUp+'" name="B_'+NomChpUp+'" value="'+val+'" onkeyup="affecterHidden(this);" class="input200"/>');
	document.write('<br/><span style="font-size:12px"><i>(par exemple : Victor Hugo)</i></span><br/>');
	<#FINSI RECHERCHE=AUTEUR>
  <#FINSI AVEC_COMPARAISON=OUI>
  document.write('</td>');
  document.write('</tr>');
  DonnerFocus(compare+"<#FOCUS>");
  DonnerFocus("<#FOCUS>");
}
</SCRIPT>
</table>
<#SI RECHERCHE=EDITEUR> <br><br><br><br><#FINSI RECHERCHE=EDITEUR>
<#SI RECHERCHE=COLLECTION>
	<input type="HIDDEN" id="THEMEPOLE1CASE2" name="THEMEPOLE1CASE2"/>
	<input type="HIDDEN" id="THEMEPOLE2CASE1" name="THEMEPOLE2CASE1"/>
<br/><br/><hr><br/>
<table width=90%>
  <tr><td width=12> </td><td align="right" valign="top">
	  <b>    sur le thème </b><br/>
	<span style="font-size:8px"><br/><br/></span>
	<span style="font-size:12px">Et</span>
	<input id="CONJONCTION_ET" name="CONJONCTION" type="radio" value="ET" onClick="changeEtOu()" checked />
	<span style="font-size:12px">  ou</span>
	<input id="CONJONCTION_OU" name="CONJONCTION" type="radio" value="OU" onClick="changeEtOu()"/>
  </td>
  <td> </td>
  <td valign="top">
	<input id="THEMEPOLE1CASE1" name="THEMEPOLE1CASE1" value="<#THEMEPOLE1CASE1>" class="input200"/>
	<span style="font-size:12px"><i> (par exemple : Egypte, eau)</i></span>
	<br/><br/>
	<input id="THEMEPOLE2" name="THEMEPOLE2" value="<#THEMEPOLE2>" class="input200" onkeyup="majNom2()"/>
	<span style="font-size:12px"><i> (par exemple : Religion, pollution)</i></span>
  </td></tr>
  <#SI LOGICIEL=BCDIECOLE>
	</table><br>
	<INPUT TYPE="HIDDEN" NAME="LANGAGEVISIBLE" VALUE="DICO"/>
  <#SINON LOGICIEL=BCDIECOLE>
  <tr><td width=12> </td><td> </td><td> </td>
  <td>
	<INPUT  name ="LANGAGEVISIBLE" type="radio" value="DICO" onclick="elargir(true)" checked /> Avec le dictionnaire&nbsp;
	<i><b><span style="font-size:12px">(chercher des mots équivalents)</b></i></span><br/>
	<INPUT  name ="LANGAGEVISIBLE"type="radio" value="TEXTESEUL" onclick="elargir(false)"/>Sans le dictionnaire<br>&nbsp;
  </td></tr>
  </table>
  <#FINSI LOGICIEL=BCDIECOLE>
<#SINON RECHERCHE=COLLECTION>
<br/>&nbsp;
<#FINSI RECHERCHE=COLLECTION>
<#FINSI EXTENSION=PLUS>
</div>
<!-- Fin du Fichier Cherche.htm -->
