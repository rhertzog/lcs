<div class="zoneafftxt">
  <div class="fiche100pr100">
	<script type="text/javascript">
	  var typeNotice="<#ChampJava Notices Type Notice>";
	  var typeDocument="<#ChampJava Documents Type Doc.>";
	  var supportNotice="<#ChampJava Notices Support N.>";

	  var noticeGenerale=(typeNotice=="Notice générale");
	  var docRessourceEnLigne=(typeDocument=="Ressource en ligne");
	  var docRessourceElectronique=(typeDocument=="Ressource électronique");

// DebFichLyc
	  if (noticeGenerale)
	  {
		ch_aff=supportNotice;
		ch_aff+=" (<#Champ Documents Date de parution>) ";
		ch_aff+="<#Champ Notices Natures><br/><br/>";
		chDocument="<#ChampJava Documents Document>";
		nbNotices=<#Champ Documents Nombre Notices>;
		if (nbNotices>1)
		 chDocument='<a href="<#URLDLL>?EQ:Document=<#ChampJava Documents Document>" title="Voir les '+nbNotices+' notices correspondantes">'+chDocument+'</a>';
		ch_aff+="<div class='titre'>"+chDocument+"</div>";
	  }
	  else
	  {
		ch_aff=typeNotice+" de "+supportNotice;
		ch_aff+=" dans <i><#ChampJava Notices Document></i>";
		ch_aff+=" (<#Champ Documents Date de parution>) ";
		ch_aff+="<#Champ Notices Collation><br/>";
		ch_aff+="<div class='titre'><#ChampJava Notices Titre></div>";
	  }
	  ch_aff+="<br/><br/>";
	  rajouterStrong("<#Intitule Notices Résumé> ","<#ChampJava Notices Résumé>");
	  rajouterStrong("<#Intitule Notices Descripteurs> ","<#ChampJava Notices Descripteurs>");
	  rajouterStrong("<#Intitule Notices Mots clés> ","<#ChampJava Notices Mots clés>");
	  rajouterStrong("<#Intitule Notices Genres> ","<#ChampJava Notices Genres>");
	  ch_aff+="<hr/>";
	  rajouterStrong("<#Intitule Notices Auteurs> ","<#ChampJava Notices Auteurs>");
	  rajouterStrong("<#Intitule Documents Editeurs> ","<#ChampJava Documents Editeurs>");
	  vel="<#ChampJava Documents N° Collection>";
	  if (vel!="") vel=", "+vel;
	  rajouterStrong("<#Intitule Documents Collection> ","<#ChampJava Documents Collection>"+vel);
	  rajouterStrong("<#Intitule Documents Date de parution> ","<#ChampJava Documents Date de parution>");
	  ch_aff+="<br/>";

// FichCompLyc


// PourCiterLyc Affichage Optionnel bouton fiche complète

	  ch_aff+='<div id="txtaffiche-<#VALEUR RANG_FICHE>"  class="cachediv">';

	  if (!noticeGenerale) rajouterStrong("<#Intitule Notices Natures> ","<#ChampJava Notices Natures>");
	  rajouterStrong("<#Intitule Notices Publics> ","<#ChampJava Notices Publics>");
	  rajouterStrong("<#Intitule Notices Niveaux> ","<#ChampJava Notices Niveaux>");
	  rajouterStrong("Disciplines : ","<#ChampJava Notices Disciplines N.>");
	  if (!noticeGenerale) rajouterStrong("<#Intitule Notices Collation> ","<#ChampJava Notices Collation>");
	  rajouterStrong("<#Intitule Notices Notes> ","<#ChampJava Notices Notes>");
	  rajouterStrong("<#Intitule Documents ISBN> ","<#ChampJava Documents ISBN>");
	  rajouterStrong("<#Intitule Documents ISSN> ","<#ChampJava Documents ISSN>");
	  rajouterStrong("<#Intitule Documents N° Normalisé> ","<#ChampJava Documents N° Normalisé>");
	  if (noticeGenerale) rajouterStrong("Ressource liée : ","<#ChampJava Documents Ressources>");
	  rajouterStrong("Ressource liée : ","<#ChampJava Notices Ressource 1>");
	  rajouterStrong("Ressource liée : ","<#ChampJava Notices Ressource 2>");
	  ch_aff+="<br/>";


	  ch_aff+="<i><b>Pour citer le document : </b></i><BR>";
	  NoticesAuteurs="<#ChampJava Notices Auteurs>";
	  if (NoticesAuteurs!="") ch_aff+="<#ChampJava Notices Auteurs>. ";

	// cas I. du cahier des charges page 11
	  if ((supportNotice=="Internet") || ((docRessourceEnLigne) && (supportNotice!="Périodique")))
	  {
		<#SI Champ Notices Type Notice = Notice générale>
			ch_aff+="<#ChampJava Notices Titre> [en ligne]. ";
			DocumentsEditeur="<#ChampJava Documents Editeurs>";
			if (DocumentsEditeur!="") ch_aff+="<#ChampJava Documents Editeurs>, ";
			dateNotice="<#Champ Documents Date de parution>"
			ch_aff+=dateNotice + ', ';
			dateNotice="<#Champ Notices Date édition N.>";
			ch_aff+='date de mise à jour ' + dateNotice + ' ';
			dateNotice="<#ChampJava Notices Date modif. N.>";
			if (dateNotice=="") dateNotice="<#ChampJava Notices Date saisie N.>";
			ch_aff+='[consulté le ' + dateNotice+ ']. ';
			NoticesCollation="<#ChampJava Notices Collation>";
			if (NoticesCollation!="") ch_aff+="<#ChampJava Notices Collation>. ";
			DocumentsCollection="<#ChampJava Documents Collection>";
			if (DocumentsCollection!="") ch_aff+="<#ChampJava Documents Collection>";
			DocumentsNumColl="<#ChampJava Documents N° Collection>";
			if (DocumentsNumColl!="") ch_aff+=", <#ChampJava Documents N° Collection>";
			ch_aff+=". &lt;<#ChampJava Notices Lien>&gt; "
		<#FINSI Champ Notices Type Notice = Notice générale>
		//
		// 
		<#SI Champ Notices Type Notice = Partie>
			ch_aff+="<#ChampJava Documents Document> [en ligne]. ";
			DocumentsEditeur="<#ChampJava Documents Editeurs>";
			if (DocumentsEditeur!="") ch_aff+="<#ChampJava Documents Editeurs>, ";
			dateNotice="<#Champ Documents Date de parution>"
			ch_aff+=dateNotice + ', ';
			dateNotice="<#Champ Notices Date édition N.>";
			ch_aff+='date de mise à jour ' + dateNotice + ' ';
			dateNotice="<#ChampJava Notices Date modif. N.>";
			if (dateNotice=="") dateNotice="<#ChampJava Notices Date saisie N.>";
			ch_aff+='[consulté le ' + dateNotice+ ']. ';
			ch_aff+="<#ChampJava Notices Titre>";
			NoticesCollation="<#ChampJava Notices Collation>";
			if (NoticesCollation!="") ch_aff+=", <#ChampJava Notices Collation>";
			ch_aff+=". &lt;<#ChampJava Notices Lien>&gt; "
		<#FINSI Champ Notices Type Notice = Partie>
		//
		<#SI Champ Notices Type Notice = Contribution>
			ch_aff+="<#ChampJava Notices Titre>. ";
			ch_aff+="In <#ChampJava Documents Document> [en ligne]. ";
			DocumentsEditeur="<#ChampJava Documents Editeurs>";
			if (DocumentsEditeur!="") ch_aff+="<#ChampJava Documents Editeurs>, ";
			dateNotice="<#Champ Documents Date de parution>"
			ch_aff+=dateNotice + ', ';
			dateNotice="<#Champ Notices Date édition N.>";
			ch_aff+='date de mise à jour ' + dateNotice + ' ';
			dateNotice="<#ChampJava Notices Date modif. N.>";
			if (dateNotice=="") dateNotice="<#ChampJava Notices Date saisie N.>";
			ch_aff+='[consulté le ' + dateNotice+ ']';
			NoticesCollation="<#ChampJava Notices Collation>";
			if (NoticesCollation!="") ch_aff+=". <#ChampJava Notices Collation>";
			ch_aff+=". &lt;<#ChampJava Notices Lien>&gt; "
		<#FINSI Champ Notices Type Notice = Contribution>
	  }
	  // cas II.
	  else if ((docRessourceEnLigne) && (supportNotice=="Périodique"))
	  {
		ch_aff+="<#ChampJava Notices Titre>. ";
		ch_aff+="<#ChampJava Documents Collection> [en ligne], ";
		ch_aff+="<#ChampJava Documents Date de parution>, ";
		ch_aff+="<#ChampJava Documents N° Collection> ";
		dateNotice="<#Champ Notices Date édition N.>";
		ch_aff+='date de mise à jour ' + dateNotice + ' ';
		dateNotice="<#ChampJava Notices Date modif. N.>";
		if (dateNotice=="") dateNotice="<#ChampJava Notices Date saisie N.>";
		ch_aff+='[consulté le ' + dateNotice+ ']';
		NoticesCollation="<#ChampJava Notices Collation>";
		if (NoticesCollation!="") ch_aff+=", <#ChampJava Notices Collation>";
		ch_aff+=". &lt;<#ChampJava Notices Lien>&gt; ";
	  }
	  // cas III
	  else if ((docRessourceElectronique) && (supportNotice!="Internet"))
	  {
		if (noticeGenerale)
		{
		  ch_aff+="<#ChampJava Notices Titre> ";
		  ch_aff+="[<#ChampJava Documents Support>]. ";
		  DocumentsEditeur="<#ChampJava Documents Editeurs>";
		  if (DocumentsEditeur!="") ch_aff+="<#ChampJava Documents Editeurs>, ";
		  ch_aff+="<#ChampJava Documents Date de parution>.";
		  NoticesCollation="<#ChampJava Notices Collation>";
		  if (NoticesCollation!="") ch_aff+="<#ChampJava Notices Collation>. ";
		  DocumentsCollection="<#ChampJava Documents Collection>";
		  if (DocumentsCollection!="") ch_aff+="<#ChampJava Documents Collection>";
		  DocumentsNumColl="<#ChampJava Documents N° Collection>";
		  if (DocumentsNumColl!="") ch_aff+=", <#ChampJava Documents N° Collection>.";
		}
		else if ((typeNotice=="Partie") || (typeNotice=="Contribution"))
		{
		  <#SI Champ Notices Type Notice = Partie>
			  ch_aff+="<#ChampJava Documents Document> ";
			  ch_aff+="[<#ChampJava Documents Support>], ";
			  DocumentsEditeur="<#ChampJava Documents Editeurs>";
			  if (DocumentsEditeur!="") ch_aff+="<#ChampJava Documents Editeurs>, ";
			  ch_aff+="<#ChampJava Documents Date de parution>. ";
			  ch_aff+="<#ChampJava Notices Titre>";
			  NoticesCollation="<#ChampJava Notices Collation>";
			  if (NoticesCollation!="") ch_aff+=", <#ChampJava Notices Collation>. ";
		  <#FINSI Champ Notices Type Notice = Partie>
		  //
		  <#SI Champ Notices Type Notice = Contribution>
			  ch_aff+="<#ChampJava Notices Titre>. ";
			  ch_aff+="In <#ChampJava Documents Document> ";
			  ch_aff+="[<#ChampJava Documents Support>], ";
			  DocumentsEditeur="<#ChampJava Documents Editeurs>";
			  if (DocumentsEditeur!="") ch_aff+="<#ChampJava Documents Editeurs>, ";
			  ch_aff+="<#ChampJava Documents Date de parution>";
			  NoticesCollation="<#ChampJava Notices Collation>";
			  if (NoticesCollation!="") ch_aff+=". <#ChampJava Notices Collation>. ";
		  <#FINSI Champ Notices Type Notice = Contribution>
		}
		else
		{
		  ch_aff+="<#ChampJava Notices Titre>. ";
		  DocumentsCollection="<#ChampJava Documents Collection>";
		  if (DocumentsCollection!="") ch_aff+="<#ChampJava Documents Collection> ";
		  ch_aff+="[<#ChampJava Documents Support>], ";
		  ch_aff+="<#ChampJava Documents Date de parution>, ";
		  ch_aff+="<#ChampJava Documents N° Collection>"
		  NoticesCollation="<#ChampJava Notices Collation>";
		  if (NoticesCollation!="") ch_aff+=", <#ChampJava Notices Collation>";
		}
		// cas IV
	  }
	  else if (supportNotice=="Périodique")
	  {
		ch_aff+="<#ChampJava Notices Titre>. ";
		ch_aff+="<#ChampJava Documents Collection>, ";
		ch_aff+="<#ChampJava Documents Date de parution>, ";
		ch_aff+="<#ChampJava Documents N° Collection>, ";
		ch_aff+="<#ChampJava Notices Collation>";
	  }
	  else if (noticeGenerale)
	  {
		ch_aff+="<#ChampJava Notices Titre>. ";
		DocumentsEditeur="<#ChampJava Documents Editeurs>";
		if (DocumentsEditeur!="") ch_aff+="<#ChampJava Documents Editeurs>, ";
		ch_aff+="<#ChampJava Documents Date de parution>";
		NoticesCollation="<#ChampJava Notices Collation>";
		if (NoticesCollation!="") ch_aff+="<#ChampJava Notices Collation>";
		DocumentsCollection=". <#ChampJava Documents Collection>";
	    if (DocumentsCollection!="") ch_aff+=". <#ChampJava Documents Collection>";
		DocumentsNumColl="<#ChampJava Documents N° Collection>";
		if (DocumentsNumColl!="") ch_aff+=", <#ChampJava Documents N° Collection>.";
	  }
	  else
	  {
	  <#SI Champ Notices Type Notice = Partie>
			ch_aff+="<#ChampJava Documents Document>. ";
			DocumentsEditeur="<#ChampJava Documents Editeurs>";
			if (DocumentsEditeur!="") ch_aff+="<#ChampJava Documents Editeurs>, ";
			ch_aff+="<#ChampJava Documents Date de parution>. ";
			ch_aff+="<#ChampJava Notices Titre>";
			NoticesCollation="<#ChampJava Notices Collation>";
			if (NoticesCollation!="") ch_aff+=", <#ChampJava Notices Collation>";
	  <#FINSI Champ Notices Type Notice = Partie>
	  //
		<#SI Champ Notices Type Notice = Contribution>
			ch_aff+="<#ChampJava Notices Titre>. ";
			ch_aff+="In <#ChampJava Documents Document>. ";
			DocumentsEditeur="<#ChampJava Documents Editeurs>";
			if (DocumentsEditeur!="") ch_aff+="<#ChampJava Documents Editeurs>, ";
			ch_aff+="<#ChampJava Documents Date de parution>. ";
			ch_aff+="<#ChampJava Notices Collation>";
		<#FINSI Champ Notices Type Notice = Contribution>
	  }
	  ch_aff+='<br/><br/></div>'; // pour le DIV cachediv
	  document.write(ch_aff);
	</script>
  </div>
</div class="zoneafftxt">

