<!-- Ecrans RM 10/12/06 -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Recherche par thésaurus</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Pragma" content="no-cache">
<link href="<#CONST REP_MODELES>bcdi.css" rel="stylesheet" type="text/css" media="screen">

<noscript></head><body onLoad="javascript:InitChecked()">Votre navigateur n'autorise pas la gestion des scripts Javascript, vous ne pouvez pas utiliser BCDI Web</noscript>
<script language="JavaScript">

var Derouler=false // A priori, on ne déroule pas les restrictions.
var DernierCode=0 // pour fKeyUp

if (parent.frames.length > 0)
  window.top.location.href = location.href;

function fKeyUp(event)
{
  if (!event)
  if (window.event) event=window.event
  if (event)
  {
     if (typeof(event.keyCode)=="number")
      DernierCode=event.keyCode;
     else if (typeof(event.which)=="number")
      DernierCode=event.which;
     else if (typeof(event.charCode)=="number")
      DernierCode=event.charCode;
//alert(DernierCode)
  }
}

  function DivStatus( nom, numero )
    {
      var divID = nom + numero;

      if(divID=="c2"){var value=''; document.forms[0].ThemePole3Case2.value=value;}
      else
      if(divID=="b2"){var value=''; document.forms[0].ThemePole2Case2.value=value;}
      else
      if(divID=="a2"){var value=''; document.forms[0].ThemePole1Case2.value=value;}

      if ( document.getElementById && document.getElementById( divID ) ) // Pour les navigateurs récents
        {
          Pdiv = document.getElementById( divID );
          PcH = true;
         }
      else if ( document.all && document.all[ divID ] ) // Pour les veilles versions
        {
          Pdiv = document.all[ divID ];
          PcH = true;
        }
      else if ( document.layers && document.layers[ divID ] ) // Pour les très veilles versions
        {
          Pdiv = document.layers[ divID ];
          PcH = true;
        }
      else
          PcH = false;

      if ( PcH )
          Pdiv.className = ( Pdiv.className == 'cachediv' ) ? '' : 'cachediv';
    }

function BasculerRestrictions() { DivStatus( 'txt', '3' ); DivStatus( 'txt', '6' ); }

function InverseTout( nom )
    {  
      var NumDiv = 1;
      if ( document.getElementById ) // Pour les navigateurs récents
        {
          while ( document.getElementById( nom + NumDiv ) )
            {
              SetDiv = document.getElementById( nom + NumDiv );
              DivStatus( nom, NumDiv );
              NumDiv++;
            }
        }
      else if ( document.all ) // Pour les veilles versions
        {
          while ( document.all[ nom + NumDiv ] )
            {
              SetDiv = document.all[ nom + NumDiv ];
              DivStatus( nom, NumDiv );
              NumDiv++;
            }
        }
      else if ( document.layers ) // Pour les très veilles versions
        {
          while ( document.layers[ nom + NumDiv ] )
            {
              SetDiv = document.layers[ nom + NumDiv ];
              DivStatus( nom, NumDiv );
              NumDiv++;
            }
        }
    }

function effacer()
{
  document.forms[0].reset()
  for (i=0;i<document.forms[0].elements.length;i++)
  if (document.forms[0].elements[i].type=="text") document.forms[0].elements[i].value=""
}

function tube(ch)
{
  while (ch.substring(0,1)==" ")
  {
   ch=ch.substring(1,ch.length)
  }
  return "|"+ch+"|"
}


function ParDefaut(ch,defaut)
{
  while (ch.substring(0,1)==" ")
  {
   ch=ch.substring(1,ch.length)
  }
  if (ch=="")
   ch=defaut
  return ch
}

function Refermer(valeur,lettre)
{
  if (valeur <= " ")
    DivStatus( lettre, '2' )
  else
    DivStatus( lettre , '1' )
}

function InitChecked()
{
  chComment=ParDefaut("<#COMMENT>","TOUS")
  chClassement=ParDefaut("<#CLASSEMENT>","TITRE")
  if (chClassement=="PERTINENCE") chClassement="TITRE"
  chFormat=ParDefaut("<#FORMAT>","LISTENOT")
  chNature=tube("<#TYPEDENATURE>")
  chSupport=tube("<#SUPPORT1>")
  chAutopostage=ParDefaut("<#AUTOPOSTAGE>","")

  for (i=0;i<document.forms[0].elements.length;i++)
  {
    if (document.forms[0].elements[i].name=="COMMENT")
    document.forms[0].elements[i].checked=(document.forms[0].elements[i].value==chComment)
    else
    if (document.forms[0].elements[i].name=="CLASSEMENT")
    document.forms[0].elements[i].checked=(document.forms[0].elements[i].value==chClassement)
    else
    if (document.forms[0].elements[i].name=="AUTOPOSTAGE")
    document.forms[0].elements[i].checked=(document.forms[0].elements[i].value==chAutopostage)
    else
    if (document.forms[0].elements[i].name=="TYPEDENATURE")
    {
      ch="|"+document.forms[0].elements[i].value+"|"
      document.forms[0].elements[i].checked=(chNature.indexOf(ch)>=0)
      if (document.forms[0].elements[i].checked) Derouler=true
    }
    else
    if (document.forms[0].elements[i].name=="SUPPORT1")
    {
      ch="|"+document.forms[0].elements[i].value+"|"
      document.forms[0].elements[i].checked=(chSupport.indexOf(ch)>=0)
      if (document.forms[0].elements[i].checked) Derouler=true
    }
    else
    if ((document.forms[0].elements[i].name.substring(0,4)=="DATE") && !(document.forms[0].elements[i].value=="")) Derouler=true
    else
    if (document.forms[0].elements[i].name.substring(0,5)=="DISPO")
    {
      document.forms[0].elements[i].checked=!("<#DISPONIBLES>"=="")
      if (document.forms[0].elements[i].checked) Derouler=true
    }
  }
  if (Derouler) BasculerRestrictions()

  Refermer("<#THEMEPOLE1CASE2>",'a')
  Refermer("<#THEMEPOLE2CASE2>",'b')
  Refermer("<#THEMEPOLE3CASE2>",'c')
}

function SansParametre(url,param)  // on enlève un champ de la liste des paramètres d'une URL
{
  p=url.indexOf("?"+param+"=");
  if (p<0)
    p=url.indexOf("&"+param+"=");
  if (p>=0)
  {
    ch=url.substring(0,p)
    reste=url.substr(p+1,10000)
    p=reste.indexOf("&");
    if (p>0)
      ch+="&"+reste.substr(p+1,10000)
    url=ch
  }
  return(url)
}
function RajouterParametre(url,nom,valeur)  // on rajoute un champ de la liste des paramètres d'une URL
{
  url=SansParametre(url,nom)
  if (valeur=="") valeur=" "
  {
    p=url.indexOf("?");
    if (p<0)
      url+="?"
    else
      url+="&"
    url+=nom+"="+escape(valeur)
  }
  return(url)
}
function valeurs_checkees(NomChp)
{
  res=""
  ListeElements=document.getElementsByName(NomChp)
  if (ListeElements.length>0)
  {
    for(var j=0; j<ListeElements.length; j++)
    {
      if (ListeElements[j].checked)
      {
        if (res>" ")
          res+="|"
        res+=ListeElements[j].value
      }
    }
  }
  return(res)
}
function init_liste(chp)  // renvoie le formulaire avec la liste correspondant au début de saisie
{
if (DernierCode!=39 && DernierCode!=37 && DernierCode!=32 && DernierCode!=9 && DernierCode!=16 && DernierCode!=17) // flêche droite
  {
//alert(DernierCode);
    ch=window.location.href;
    for(var n=0; n<aFic_Chp.length; n++)
    {
      chpn=aChp[n].toUpperCase()
      ch=RajouterParametre(ch,chpn,document.forms[0].elements[chpn].value)
      ch=RajouterParametre(ch,aFic_Chp[n],document.forms[0].elements[chpn].value)
      if (chp==chpn)
      {
        ch=RajouterParametre(ch,"COMPARE_"+chpn,vc)
      }
      else
        ch=RajouterParametre(ch,"COMPARE_"+chpn,valeurs_checkees("COMPARE_"+chpn))
      ch=RajouterParametre(ch,"CLASSEMENT",valeurs_checkees("CLASSEMENT"))
      ch=RajouterParametre(ch,"SUPPORT1",valeurs_checkees("SUPPORT1"))
      ch=RajouterParametre(ch,"TYPEDENATURE",valeurs_checkees("TYPEDENATURE"))
      ch=RajouterParametre(ch,"DISPO",valeurs_checkees("DISPONIBILITE"))
      ch=RajouterParametre(ch,"FOCUS",chp)
      ch=RajouterParametre(ch,"FICHIER",document.forms[0].FICHIER.value)
      ch=RajouterParametre(ch,"NP",document.forms[0].NP.value)
      window.location.href=ch;
    }
  }
}

</script>





<form action="#" name="recherche" method="post">

<div class="zonemenu">
  <div class="fxcal">
  <div class="menucalibre">&nbsp;</div>
  <div class="menuOFF"><div class="menuOFFgauche"></div><div class="menuOFFtxt"><a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=index.htm">Recherche thématique</a></div><div class="menuOFFdroite"></div></div>
  <div class="menuOFF"><div class="menuOFFgauche"></div><div class="menuOFFtxt"><a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=rech-criteres.htm">Recherche par critères</a></div>  <div class="menuOFFdroite"></div></div>
  <div class="menuON"><div class="menuONgauche"></div><div class="menuONtxt"><a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=rech-thesaurus.htm">Recherche par Thésaurus</a></div><div class="menuONdroite"></div></div>

<script type="text/javascript">
<!--
if (<#VALEUR NOMBRE_PANIER>>0){
  var plur="";
  if (<#VALEUR NOMBRE_PANIER>>1){ plur="s";}
document.write("<div class='menuOFFp'><div class='menuOFFgauchep'><\/div><div><a href='<#URLDLL>?np=<#NUMERO_PANIER>&fichier=Panier.htm&FICHIERORIGINE=Panier.htm' class='menupaniertxt' ");
document.write("><span class='menupaniertxt2'>Voir mon panier<\/span> (<#VALEUR NOMBRE_PANIER> fiche");
document.write(plur);
document.write(")<\/a><\/div><div class='menuOFFdroitep'><\/div><\/div>");
}
else{      
  document.write('<div class=\"menuOFF\"><div class=\"menuOFFgauche\"><\/div><div class=\"menuOFFtxt\">');
  document.write('<span class="pasdepanier">Votre panier est vide<\/span>');
  document.write('<\/div><div class=\"menuOFFdroite\"><\/div><\/div>');
  }
  if("<#CONST AFFCOMPTE>"=="NON" || "<#LOGICIEL>"=="BCDI"){document.write('<div class="cachediv">');}
  -->
  </script>

  <div class="menuOFF">
    <div class="menuOFFgauche">&nbsp;</div>
    <div class="menuOFFtxtcompte"><a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=identification.htm">Mon compte</a></div>
    <div class="menuOFFdroite">&nbsp;</div>
  </div>
  <script type="text/javascript">
  <!--
  if("<#CONST AFFCOMPTE>"=="NON" || "<#LOGICIEL>"=="BCDI"){document.write('</div>');}
  -->
  </script>
</div>

<div class="menuseparatsuite">
  <div class="txt100pr100">&nbsp;</div>
  <div class="menucalibre">&nbsp;</div>
  <a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=rech-thesaurus.htm" class="menuseparatlienON" title="recherche">Recherche par thésaurus</a>
  <a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=VisitTh.htm" class="menuseparatlienOFF" title="Visualisation">Visualisation du Thésaurus</a>
  <div class="txt100pr100">&nbsp;</div>
</div>


<div class="menuzonedatag">
    <div class="menuzonedata"><br>
               <!-- <div class="tridroite">-->
                <!-- javascript:visitthesaurus('<#URLDLL>?modele=VisitTh')-->
                  
                  
                  
          
        <div class="tridroitetitre"><font size="+1"> Recherche incorrecte : <#REPONSE2></font>
        <!--  </div>-->
        </div>
        <div class="txt10"> </div>
        <div ID="a1">&nbsp; </div>
        <div ID="a2">
          <p><b><font size="+1">&nbsp;
            </font></b></p>
          <p><font size="+1"><b>Seuls les descripteurs sont accept&eacute;s dans 
            la recherche par th&eacute;saurus.</b></font><br>
            <br>
<input type="button" value="Retour" onClick="history.back()" name="button">
          </p>
        </div>


  <!--              <div class="zoneclass">
<div class="classementformat2"></div>     
                    </div>
                  <br><br>
                  
                <div class="txt4">
          <div class="txt2"></div>
         -->       
          <div align="center"> </div>
        </div>
    </div></div>

  <div id="txt6">
    <div class="menuzonedatafooter">
      <div class="menuzonedatafooterg"></div>
      <div class="menuzonedatafooterd"></div>
    </div>
  </div>

    <div id="txt3" class='cachediv'>
    <div class="menuzonedatagoption">
    <div class="menuzonedataoption">
    <div class="txt4"><img src="<#CONST REP_MODELES>puceoptions.gif" width="10" height="12" alt=""><b>Restreindre :</b><br>
      <#BOUCLE CHAMP="TYPES NATURE" TEXTE="<div class='support'><input name='TYPEDENATURE' type='checkbox' value='?VALEUR?'>?VALEUR?</div>">        
    </div>    
    <div class="txt4"><img src="<#CONST REP_MODELES>puceoptions.gif" width="10" height="12" alt=""><b>Restreindre aux supports suivants :</b><br>
     <#BOUCLE CHAMP="Support N." TEXTE="<div class='support'><input name='SUPPORT1' type='checkbox' value='?VALEUR?'><img src='<#CONST REP_MODELES>PUCE?VALEUR MAJ?.gif' width=26 height=26>?VALEUR?</div>">
    </div>
    <div class="txt4">
      <div class="txt5"><div class="zonedate1"><img src="<#CONST REP_MODELES>puceoptions.gif" width="10" height="12" alt=""><b>Date de parution =</b>&nbsp;</div><div class="zonedate2"><input name="DATEEGAL" type="text" class="input100" value="<#DATEEGAL>"> <span class="gris">(jj/mm/aaaa)</span></div></div>
      <div class="txt5">
        <div class="zonedate1"><b>Avant </b>&nbsp;</div><div class="zonedate2"><input name="DATEINF" type="text" class="input100" value="<#DATEINF>"> <span class="gris">(jj/mm/aaaa)</span></div>
      </div>
      <div class="txt5">
        <div class="zonedate1"><b>Après </b>&nbsp;</div><div class="zonedate2"><input name="DATESUP" type="text" class="input100" value="<#DATESUP>"> <span class="gris">(jj/mm/aaaa)</span></div>
      </div>
    </div>
                  
    <script type="text/javascript">
      if("<#CONST AFFDISPONIBILITE>"=="NON"){document.write('<div class="cachediv">');}
    </script>
    <div class="txt4"><img src="<#CONST REP_MODELES>puceoptions.gif" width="10" height="12" alt=""><b>Documents disponibles</b>
    <input name="DISPONIBLES" value="DISPONIBLE" type="checkbox"></div>
    <script type="text/javascript">
      if("<#CONST AFFDISPONIBILITE>"=="NON"){document.write('</div>');}
    </script>
    
  </div></div>
  <div class="menuzonedatafooter"><div class="menuzonedatafooterg"></div><div class="menuzonedatafooterd"></div></div>
  </div>
  
<INPUT TYPE="HIDDEN" NAME="np" VALUE="<#VALEUR NUMERO_PANIER>">
<INPUT TYPE="HIDDEN" NAME="hidden1" VALUE="ch">
<INPUT TYPE="HIDDEN" NAME="FICHIERORIGINE" VALUE="<#FICHIER>">
<INPUT TYPE="HIDDEN" NAME="FICHIER" VALUE="RECH-THESAURUS.HTM">
<INPUT TYPE="HIDDEN" NAME="LANGAGE" VALUE="THESAURUS">
<INPUT TYPE="HIDDEN" NAME="FORMAT" VALUE="LISTENOT">

</form>
</body>
</html>
