<!-- 17/11/2008 RECH-AVANCEE.HTM -->
<#VAR RECHERCHE=THEME>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Recherche avancée</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Pragma" content="no-cache">
<link href="<#CONST REP_MODELES>bcdi.css" rel="stylesheet" type="text/css" media="screen">

<noscript>Votre navigateur n'autorise pas la gestion des scripts Javascript, vous ne pouvez pas utiliser BCDI Web</noscript>
<script language="JavaScript">

var Derouler=false // A priori, on ne déroule pas les restrictions.
var fichierEnCours="RECH-AVANCEE.HTM"
  function DivStatus( nom, numero )
    {
    
      var divID = nom + numero;
      
      if(divID=="c2"){var value=''; document.forms[0].THEMEPOLE3CASE2.value=value;}
      else
      if(divID=="b2"){var value=''; document.forms[0].THEMEPOLE2CASE2.value=value;}
      else
      if(divID=="a2"){var value=''; document.forms[0].THEMEPOLE1CASE2.value=value;}
      
      if ( document.getElementById && document.getElementById( divID ) ) // Pour les navigateurs récents
        {
          Pdiv = document.getElementById( divID );
          PcH = true;
         }
      else if ( document.all && document.all[ divID ] ) // Pour les veilles versions
        {
          Pdiv = document.all[ divID ];
          PcH = true;
        }
      else if ( document.layers && document.layers[ divID ] ) // Pour les très veilles versions
        {
          Pdiv = document.layers[ divID ];
          PcH = true;
        }
      else
          PcH = false;
      if ( PcH )
          Pdiv.className = ( Pdiv.className == 'cachediv' ) ? '' : 'cachediv';
    }

function BasculerRestrictions() { DivStatus( 'txt', '3' ); DivStatus( 'txt', '6' ); }

function effacer()
{
  document.forms[0].reset()
  for (i=0;i<document.forms[0].elements.length;i++)  with (document.forms[0].elements[i])
  {
	if (type=="text") value=""
	if (type=="checkbox") checked=false
	if (type=="select-one") options[0].selected = true;
  }
}

function tube(ch)
{
  while (ch.substring(0,1)==" ")
   ch=ch.substring(1,ch.length)
  return "|"+ch+"|"
}
function ParDefaut(ch,defaut)
{
  while (ch.substring(0,1)==" ")
   ch=ch.substring(1,ch.length)
  if (ch=="")
   ch=defaut
  return ch
}

/*
function Refermer(valeur,lettre)
{
  if (valeur <= " ")
	DivStatus( lettre, '2' )
  else
	DivStatus( lettre , '1' )
}
*/

function ChangerOptions(nom,valeur)
{
  selectBox = document.getElementById(nom);
  if (selectBox.options.length>0) {
	if (valeur=='') valeur=selectBox.options[0].text;
	for (var i=0; i<selectBox.options.length; i++)
	if (selectBox.options[i].text==valeur) {
	  selectBox.options[i].selected = true;
	  if (i>0) Derouler=true;
	}
  }
}

function InitChecked()
{
  chComment=ParDefaut("<#COMMENT>","TOUS")
  chClassement=ParDefaut("<#CLASSEMENT>","PERTINENCE")
  chLangage=ParDefaut("<#LANGAGE>","DICO").substr(0,4)
  chFormat=ParDefaut("<#FORMAT>","LISTENOT")
  chNature=tube("<#TYPEDENATURE>")
  chSupport=tube("<#SUPPORT1>")
  for (i=0;i<document.forms[0].elements.length;i++)
  {
    if (document.forms[0].elements[i].name=="COMMENT")
    document.forms[0].elements[i].checked=(document.forms[0].elements[i].value==chComment)
    else
    if (document.forms[0].elements[i].name=="CLASSEMENT")
    document.forms[0].elements[i].checked=(document.forms[0].elements[i].value==chClassement)
	else
    if (document.forms[0].elements[i].name=="LANGAGE")
    {document.forms[0].elements[i].checked=(document.forms[0].elements[i].value.substr(0,4)==chLangage)}
	else
    if (document.forms[0].elements[i].name=="TYPEDENATURE")
    {
      ch="|"+document.forms[0].elements[i].value+"|"
      document.forms[0].elements[i].checked=(chNature.indexOf(ch)>=0)
      if (document.forms[0].elements[i].checked) Derouler=true
    }
    else
    if (document.forms[0].elements[i].name=="SUPPORT1")
    {
      ch="|"+document.forms[0].elements[i].value+"|"
      document.forms[0].elements[i].checked=(chSupport.indexOf(ch)>=0)
      if (document.forms[0].elements[i].checked) Derouler=true
    }
    else
    if ((document.forms[0].elements[i].name.substring(0,4)=="DATE") && !(document.forms[0].elements[i].value=="")) Derouler=true
    else
    if (document.forms[0].elements[i].name.substring(0,5)=="DISPO")
    {
      document.forms[0].elements[i].checked=!("<#DISPONIBLES>"=="")
      if (document.forms[0].elements[i].checked) Derouler=true
    }
  }
  ChangerOptions('GENRES',"<#GENRES>")
  ChangerOptions('NATURES',"<#NATURES>")
  ChangerOptions('NIVEAUX',"<#NIVEAUX>")
  ChangerOptions('DISCIPLINES',"<#DISCIPLINES>")
  ChangerOptions('PUBLICS',"<#PUBLICS>")
  ChangerOptions("CENTRE D'INTERET","<#CENTRE_D_INTERET>")
  ancienFichierMaitre="<#VAR FICHIER-MAITRE>";
<#VAR FICHIER-MAITRE=RECH-AVANCEE.HTM>
  if (ancienFichierMaitre!="<#VAR FICHIER-MAITRE>") {effacer(); Derouler=false;}
  if (Derouler) BasculerRestrictions()
/*
  Refermer("<#THEMEPOLE1CASE2>",'a')
  Refermer("<#THEMEPOLE2CASE2>",'b')
  Refermer("<#THEMEPOLE3CASE2>",'c')
*/
}

</script>

</head>

<body onLoad="javascript:InitChecked()">
<form action="<#URLDLL>" name="recherche" method="post">
<INPUT TYPE="HIDDEN" NAME="NP" VALUE=<#VALEUR NUMERO_PANIER>>
<INPUT TYPE="HIDDEN" NAME="FICHIERORIGINE" VALUE="RECH-AVANCEE.HTM">
<INPUT TYPE="HIDDEN" NAME="FICHIER" VALUE="RECH-AVANCEE.HTM">
<INPUT TYPE="HIDDEN" NAME="RESTRICTIONS" VALUE="OUI">
<INPUT TYPE="HIDDEN" NAME="FORMAT" VALUE="LISTENOT">
<INPUT TYPE="HIDDEN" NAME="CLASSEMENT" VALUE="PERTINENCE">
<INPUT TYPE="HIDDEN" NAME="AUTOPOSTAGE" VALUE="">
<INPUT TYPE="HIDDEN" NAME="FORMULAIRE_RECHERCHE" VALUE="RECH-AVANCEE" >
<div class="zonemenu">
  <div class="fxcal">
	<div class="menucalibre">&nbsp;</div>
	<div class="menuON"><div class="menuONgauche"></div><div class="menuONtxt"><a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=RECH-AVANCEE.HTM&MODELE=index.htm">Recherche th&eacute;matique</a></div><div class="menuONdroite"></div>
	</div>
	<div class="menuOFF"><div class="menuOFFgauche"></div><div class="menuOFFtxt"><a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=RECH-AVANCEE.HTM&MODELE=rech-criteres.htm">Recherche par crit&egrave;res</a></div>  <div class="menuOFFdroite"></div>
	</div>
	<div class="menuOFF"><div class="menuOFFgauche"></div><div class="menuOFFtxt"><a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=RECH-AVANCEE.HTM&MODELE=VisitTh.htm">Recherche par th&eacute;saurus</a></div><div class="menuOFFdroite"></div>
	</div>

<#INCLUDE INCLUDE-PANIER-COMPTE.HTM>

  </div>

  <div class="menuseparatsuite">
	<div class="txt100pr100">&nbsp;</div>
	<div class="menucalibre">&nbsp;</div>
  <a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=RECH-AVANCEE.HTM&MODELE=index.htm" class="menuseparatlienOFF" title="recherche rapide">Recherche rapide</a>
  <a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=RECH-AVANCEE.HTM&MODELE=rech-avancee.htm" class="menuseparatlienON" title="Recherche avancée">Recherche avanc&eacute;e</a>
  <font size="+1"><B>&nbsp;&nbsp;&nbsp;&nbsp;<#CONST NOM_BASE></B></font>
    <div class="txt100pr100">&nbsp;</div>
  </div>
  <div class="menuzonedatag">
    <div class="menuzonedata"><br>
	<br>
	  <div class="txt10">
		<div class="txt0"><b>Je cherche :</b>&nbsp;</div>
	  <input name="THEMEPOLE1CASE1" value="<#THEMEPOLE1CASE1>" type="text" class="input200">
		  &nbsp;Ou&nbsp;<input name="THEMEPOLE1CASE2" value="<#THEMEPOLE1CASE2>" type="text" class="input200">
	  </div>

	<br><br>

	  <div class="txt10">
		<div class="txt0">&nbsp;Et&nbsp;</div>
	  <input name="THEMEPOLE2CASE1"  value="<#THEMEPOLE2CASE1>" type="text" class="input200">
	  &nbsp;Ou&nbsp;<input name="THEMEPOLE2CASE2"  value="<#THEMEPOLE2CASE2>" type="text" class="input200">
	  </div>

	<br><br>

	  <div class="txt10">
		<div class="txt0">&nbsp;Et&nbsp;</div>
		<input name="THEMEPOLE3CASE1"  value="<#THEMEPOLE3CASE1>" type="text" class="input200">
			&nbsp;Ou&nbsp;<input name="THEMEPOLE3CASE2"  value="<#THEMEPOLE3CASE2>" type="text" class="input200">
	  </div>

	<br><br>

	  <div class="txt10">
		<div class="txt0">&nbsp;Sauf :&nbsp;</div>
	  <input name="THEMESAUFCASE1" value="<#THEMESAUFCASE1>" type="text" class="input200">
	  </div>

	<br>
	<#SI AFFDICO=OUI>
		   <br>
		   <div>
			 <INPUT  name ="LANGAGE" type="radio" value="TEXTESEUL" onclick="elargir(false)">Sans Dico&nbsp;&nbsp;&nbsp;&nbsp;
			 <INPUT  name ="LANGAGE" type="radio" value="DICO" onclick="elargir(true)"> Avec Dico &nbsp;
			 <font size=-1><i>(mots équivalents)</i></font>
		   </div>
		   <#SINON AFFDICO=OUI>
		   <INPUT TYPE=HIDDEN NAME=LANGAGE VALUE=TEXTESEUL>
		   <#FINSI AFFDICO=OUI>
	<br>
	  <div class="txt4">
		<p>&nbsp;</p>
		<div class="txt2"><a href="javascript:BasculerRestrictions()">Restrictions de recherche</a></div>
		<div align="center">
		  <input name="Rechercher" type="submit" value="Rechercher" class="bouton1">
		  <input name="Effacer" type="button" value="Effacer" class="bouton2" onclick="effacer()">
		</div>
	  </div>
	</div>
  </div>

  <#INCLUDE INCLUDE-RESTRICTIONS.HTM>

</div>
</form>
</body>
</html>

