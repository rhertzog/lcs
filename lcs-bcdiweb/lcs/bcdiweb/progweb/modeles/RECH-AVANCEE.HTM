<#VAR RECHERCHE=THEME>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Recherche avancée</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Pragma" content="no-cache">
<link href="<#CONST REP_MODELES>bcdi.css" rel="stylesheet" type="text/css" media="screen">

<noscript>Votre navigateur n'autorise pas la gestion des scripts Javascript, vous ne pouvez pas utiliser BCDI Web</noscript>
<script language="JavaScript">

var Derouler=false // A priori, on ne déroule pas les restrictions.
var fichierEnCours="RECH-AVANCEE.HTM"
  function DivStatus( nom, numero )
    {
    
      var divID = nom + numero;
      
      if(divID=="c2"){var value=''; document.forms[0].THEMEPOLE3CASE2.value=value;}
      else
      if(divID=="b2"){var value=''; document.forms[0].THEMEPOLE2CASE2.value=value;}
      else
      if(divID=="a2"){var value=''; document.forms[0].THEMEPOLE1CASE2.value=value;}
      
      if ( document.getElementById && document.getElementById( divID ) ) // Pour les navigateurs récents
        {
          Pdiv = document.getElementById( divID );
          PcH = true;
         }
      else if ( document.all && document.all[ divID ] ) // Pour les veilles versions
        {
          Pdiv = document.all[ divID ];
          PcH = true;
        }
      else if ( document.layers && document.layers[ divID ] ) // Pour les très veilles versions
        {
          Pdiv = document.layers[ divID ];
          PcH = true;
        }
      else
          PcH = false;
      if ( PcH )
          Pdiv.className = ( Pdiv.className == 'cachediv' ) ? '' : 'cachediv';
    }

function BasculerRestrictions() { DivStatus( 'txt', '3' ); DivStatus( 'txt', '6' ); }

function effacer()
{
  document.forms[0].reset()
  for (i=0;i<document.forms[0].elements.length;i++)
  {
    if (document.forms[0].elements[i].type=="text") document.forms[0].elements[i].value=""
    if (document.forms[0].elements[i].type=="checkbox") document.forms[0].elements[i].checked=false
  }
}

function tube(ch)
{
  while (ch.substring(0,1)==" ")
   ch=ch.substring(1,ch.length)
  return "|"+ch+"|"
}
function ParDefaut(ch,defaut)
{
  while (ch.substring(0,1)==" ")
   ch=ch.substring(1,ch.length)
  if (ch=="")
   ch=defaut
  return ch
}

function Refermer(valeur,lettre)
{
  if (valeur <= " ")
    DivStatus( lettre, '2' )
  else
    DivStatus( lettre , '1' )
}

function ChangerOptions(nom,valeur)
{
  if (valeur>'') {
    var selectBox = document.getElementById(nom);
    for (var i=0; i<selectBox.options.length; i++) {
      if (selectBox.options[i].text==valeur) {
        selectBox.options[i].selected = true;
        if (i>0) Derouler=true;
      }
    }
  }
}

function InitChecked()
{
  chComment=ParDefaut("<#COMMENT>","TOUS")
  chClassement=ParDefaut("<#CLASSEMENT>","PERTINENCE")
  chFormat=ParDefaut("<#FORMAT>","LISTENOT")
  chNature=tube("<#TYPEDENATURE>")
  chSupport=tube("<#SUPPORT1>")
  for (i=0;i<document.forms[0].elements.length;i++)
  {
    if (document.forms[0].elements[i].name=="COMMENT")
    document.forms[0].elements[i].checked=(document.forms[0].elements[i].value==chComment)
    else
    if (document.forms[0].elements[i].name=="CLASSEMENT")
    document.forms[0].elements[i].checked=(document.forms[0].elements[i].value==chClassement)
    else
    if (document.forms[0].elements[i].name=="TYPEDENATURE")
    {
      ch="|"+document.forms[0].elements[i].value+"|"
      document.forms[0].elements[i].checked=(chNature.indexOf(ch)>=0)
      if (document.forms[0].elements[i].checked) Derouler=true
    }
    else
    if (document.forms[0].elements[i].name=="SUPPORT1")
    {
      ch="|"+document.forms[0].elements[i].value+"|"
      document.forms[0].elements[i].checked=(chSupport.indexOf(ch)>=0)
      if (document.forms[0].elements[i].checked) Derouler=true
    }
    else
    if ((document.forms[0].elements[i].name.substring(0,4)=="DATE") && !(document.forms[0].elements[i].value=="")) Derouler=true
    else
    if (document.forms[0].elements[i].name.substring(0,5)=="DISPO")
    {
      document.forms[0].elements[i].checked=!("<#DISPONIBLES>"=="")
      if (document.forms[0].elements[i].checked) Derouler=true
    }
  }
  ChangerOptions('GENRES',"<#GENRES>")
  ChangerOptions('NATURES',"<#NATURES>")
  ChangerOptions('NIVEAUX',"<#NIVEAUX>")
  ChangerOptions('DISCIPLINES',"<#DISCIPLINES>")
  ChangerOptions('PUBLICS',"<#PUBLICS>")
  ancienFichierMaitre="<#VAR FICHIER-MAITRE>";
<#VAR FICHIER-MAITRE=RECH-AVANCEE.HTM>
  if (ancienFichierMaitre!="<#VAR FICHIER-MAITRE>") {effacer(); Derouler=false;}
  if (Derouler) BasculerRestrictions()

  Refermer("<#THEMEPOLE1CASE2>",'a')
  Refermer("<#THEMEPOLE2CASE2>",'b')
  Refermer("<#THEMEPOLE3CASE2>",'c')
}

</script>

</head>

<body onLoad="javascript:InitChecked()">
<form action="<#URLDLL>" name="recherche" method="post">
<INPUT TYPE="HIDDEN" NAME="NP" VALUE=<#VALEUR NUMERO_PANIER>>
<INPUT TYPE="HIDDEN" NAME="FICHIERORIGINE" VALUE="RECH-AVANCEE.HTM">
<INPUT TYPE="HIDDEN" NAME="FICHIER" VALUE="RECH-AVANCEE.HTM">
<INPUT TYPE="HIDDEN" NAME="RESTRICTIONS" VALUE="OUI">
<INPUT TYPE="HIDDEN" NAME="FORMAT" VALUE="LISTENOT">
<INPUT TYPE="HIDDEN" NAME="LANGAGE" VALUE="DICO">
<INPUT TYPE="HIDDEN" NAME="CLASSEMENT" VALUE="PERTINENCE">
<INPUT TYPE="HIDDEN" NAME="FORMULAIRE_RECHERCHE" VALUE="RECH-AVANCEE" >
<div class="zonemenu">
  <div class="fxcal">
    <div class="menucalibre">&nbsp;</div>
    <div class="menuON"><div class="menuONgauche"></div><div class="menuONtxt"><a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=RECH-AVANCEE.HTM&MODELE=index.htm">Recherche thématique</a></div><div class="menuONdroite"></div>
    </div>
    <div class="menuOFF"><div class="menuOFFgauche"></div><div class="menuOFFtxt"><a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=RECH-AVANCEE.HTM&MODELE=rech-criteres.htm">Recherche par critères</a></div>  <div class="menuOFFdroite"></div>
    </div>
    <div class="menuOFF"><div class="menuOFFgauche"></div><div class="menuOFFtxt"><a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=RECH-AVANCEE.HTM&MODELE=VisitTh.htm">Recherche par thésaurus</a></div><div class="menuOFFdroite"></div>
    </div>

<#INCLUDE Include-Panier-Compte.htm>

  </div>

  <div class="menuseparatsuite">
    <div class="txt100pr100">&nbsp;</div>
    <div class="menucalibre">&nbsp;</div>
  <a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=RECH-AVANCEE.HTM&MODELE=index.htm" class="menuseparatlienOFF" title="recherche rapide">Recherche rapide</a>
  <a href="<#URLDLL>?np=<#NUMERO_PANIER>&fichier=RECH-AVANCEE.HTM&MODELE=rech-avancee.htm" class="menuseparatlienON" title="Recherche avancée">Recherche avancée</a>
  <font size="+1"><B>&nbsp;&nbsp;&nbsp;&nbsp;<#CONST NOM_BASE></B></font>
    <div class="txt100pr100">&nbsp;</div>
  </div>
  <div class="menuzonedatag">
    <div class="menuzonedata"><br>
      <!-- div class="tridroite">
        <div class="tridroitetitre">Classement des résultats par : </div>
      <input name="CLASSEMENT" type="radio" value="PERTINENCE" checked> Pertinence
      <br><input name="CLASSEMENT" type="radio" value="TITRE"> Titre
      <br><input name="CLASSEMENT" type="radio" value="AUTEUR, TITRE"> Auteur
      <br><input name="CLASSEMENT" type="radio" value="SUPPOR, TITRET"> Support
      <br><input name="CLASSEMENT" type="radio" value="DATE PARUTION, TITRE"> Date
      </div -->
    <br>
      <div class="txt10">
        <div class="txt0"><b>Je cherche :</b>&nbsp;</div>
      <input name="THEMEPOLE1CASE1" value="<#THEMEPOLE1CASE1>" type="text" class="input200">
      </div>
      <div ID="a1">&nbsp;<b><a href="javascript:DivStatus( 'a', '1' );javascript:DivStatus( 'a', '2' )" class="plusmoins" title="Ajouter un champ supplémentaire">+</a></b></div>
      <div ID="a2">
      &nbsp;Ou&nbsp;<input name="THEMEPOLE1CASE2" value="<#THEMEPOLE1CASE2>" type="text" class="input200">
      &nbsp;<b><a href="javascript:DivStatus( 'a', '1' );javascript:DivStatus( 'a', '2' )" class="plusmoins" title="Masquer ce champ">-</a></b>
      </div>

    <br><br>

      <div class="txt10">
        <div class="txt0">&nbsp;Et&nbsp;</div>
      <input name="THEMEPOLE2CASE1"  value="<#THEMEPOLE2CASE1>" type="text" class="input200">
      </div>
      <div ID="b1">&nbsp;<b><a href="javascript:DivStatus( 'b', '1' );javascript:DivStatus( 'b', '2' )" class="plusmoins" title="Ajouter un champ supplémentaire">+</a></b></div>
      <div ID="b2">
      &nbsp;Ou&nbsp;<input name="THEMEPOLE2CASE2"  value="<#THEMEPOLE2CASE2>" type="text" class="input200">
      &nbsp;<b><a href="javascript:DivStatus( 'b', '1' );javascript:DivStatus( 'b', '2' )" class="plusmoins" title="Masquer ce champ">-</a></b>
      </div>

    <br><br>

      <div class="txt10">
        <div class="txt0">&nbsp;Et&nbsp;</div>
      <input name="THEMEPOLE3CASE1"  value="<#THEMEPOLE3CASE1>" type="text" class="input200">
      </div>
      <div ID="c1">&nbsp;<b><a href="javascript:DivStatus( 'c', '1' );javascript:DivStatus( 'c', '2' )" class="plusmoins" title="Ajouter un champ supplémentaire">+</a></b></div>
      <div ID="c2">
      &nbsp;Ou&nbsp;<input name="THEMEPOLE3CASE2"  value="<#THEMEPOLE3CASE2>" type="text" class="input200">
      &nbsp;<b><a href="javascript:DivStatus( 'c', '1' );javascript:DivStatus( 'c', '2' )" class="plusmoins" title="Masquer ce champ">-</a></b>
      </div>

    <br><br>

      <div class="txt10">
        <div class="txt0">&nbsp;Sauf :&nbsp;</div>
      <input name="THEMESAUFCASE1" value="<#THEMESAUFCASE1>" type="text" class="input200">
      </div>

    <br><br>

      <div class="txt4">
        <p>&nbsp;</p>
        <div class="txt2"><a href="javascript:BasculerRestrictions()">Restrictions de recherche</a></div>
        <div align="center">
          <input name="Rechercher" type="submit" value="Rechercher" class="bouton1">
          <input name="Effacer" type="button" value="Effacer" class="bouton2" onclick="effacer()">
        </div>
      </div>
    </div>
  </div>

  <#INCLUDE Include-Restrictions.htm>

</div>
</form>
</body>
</html>

