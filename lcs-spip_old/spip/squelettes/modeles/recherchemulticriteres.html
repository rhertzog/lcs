[(#REM)
######################################################################
# RECHERCHE MULTI-CRITERES                                           #
#                                                                    #
# Auteurs : Dominique (Dom) Lepaisant                                #
# www.etab.ac-caen.fr/bureaudestests/TiSpip/                         #
# Stéphanie De Nadaï - www.webdesigneuse.net                         #
#  - Fev 2008                                                        #
#                                                                    #
# Adaptation de la contrib de Paul Sanchez - www.Netdeveloppeur.com  #
#                                                                    #
# Ce programme est un logiciel libre distribue sous licence GNU/GPL. #
# Pour plus de details voir le fichier COPYING.txt                   #
######################################################################]

[(#REM) On recupere l'id rubrique et on lui attribue 0 s'il n'existe pas ]
<B_rmc_rubrique><BOUCLE_rmc_rubrique(RUBRIQUES){id_rubrique}> </BOUCLE_rmc_rubrique>
	#SET{idrub,#ID_RUBRIQUE}
</B_rmc_rubrique>
	#SET{idrub,0}
<//B_rmc_rubrique>

<BOUCLE_principale(SPIP_RMC_RUBS_GROUPES){id_rubrique=#GET{idrub}}{0,1}>


	[(#SET{taille,#CONFIG{Recherche multicritere/taillepol}})]
	[(#SET{coul,#CONFIG{Recherche multicritere/hexvalpol}})]
	[(#SET{bord,#CONFIG{Recherche multicritere/hexval}})]

[(#REM) Tentavive de ne pas afficher les styles s'il ne sont pas configurés ligne 45 : 
		pas très propre : si tou vide, affiche style="; ; ;"
]
	[(#GET{taille}|!={""}|?{#SET{taille, font-size:#GET{taille}}})]
	[(#GET{coul}|!={""}|?{#SET{coul, color:#GET{coul}}})]
	[(#GET{bord}|!={""}|?{#SET{bord, border:1px solid #GET{bord}}})]
[(#ID_RUBRIQUE|?{
<div class="rubriques" syle="background:transparent;font-weight:normal;font-size:.8em;">
	<h3 class="menu-titre"><:rmc:titre_page_admin:>toto</h3>
	<dl id="rmc_bloc_side" class="demi_boite">
		<dd style="text-align:center;margin:.37em 0 0 0">
	,
	<dl class="bloc">
		<dt class="annonce"><:rmc:titre_page_admin:></dt>
		<dd class="annonce">
})]
			<form action="spip.php?page=rec_mc_result" method="post" id="form_mc"[ (#ID_RUBRIQUE|?{ style="width:auto;font-size:0.9em;background:#ffffff;"})]>
			[(#REM)
				<div class="multicriteres"[ style="color:(#GET{coul})"]>
					<h2><:rmc:titre_page_admin:></h2>
				</div>
			]
				<fieldset>
					<legend id="bouton_list_mots"><:rmc:liste_mots:></legend>
					<input type="hidden" name="id_rubrique" value="#GET{idrub}" />
					<div class="liste_mc" id="list_mc" style="[(#GET{coul});][ (#GET{bord});][ (#GET{taille});]">
					<p><em><:rmc:aide_select_multi:></em></p>

					[(#REM) On recherche les groupes de mots attribues à la rubrique en cours ou au secteur]
						<BOUCLE_rmc_groupesparrubrique(GROUPES_MOTS spip_rmc_rubs_groupes){id_rubrique=#GET{idrub}}>
							<div style="[width:(#GET{largeur})]"> 
								<p>
									<label for="#TITRE">#TITRE</label>
								</p>
								[(#CONFIG{Recherche multicritere/checklist#ID_GROUPE}|=={list_multi#ID_GROUPE}|?{' '})[(#MODELE{rec_mc_list_multi}{id_groupe}{titre=#TITRE}{largeur=#ENV{largeur}})] ]
								[(#CONFIG{Recherche multicritere/checklist#ID_GROUPE}|=={list#ID_GROUPE}|?{' '})[(#MODELE{rec_mc_list}{id_groupe}{titre=#TITRE}{largeur=#ENV{largeur}})] ]
								[(#CONFIG{Recherche multicritere/checklist#ID_GROUPE}|=={check#ID_GROUPE}|?{' '})[(#MODELE{rec_mc_check}{id_groupe}{titre=#TITRE})] ]
								[(#CONFIG{Recherche multicritere/checklist#ID_GROUPE}|=={radio#ID_GROUPE}|?{' '})[(#MODELE{rec_mc_radio}{id_groupe}{titre=#TITRE})] ]
								[(#CONFIG{Recherche multicritere/checklist#ID_GROUPE}|?{'',' '})[(#MODELE{rec_mc_list_multi}{id_groupe}{titre=#TITRE})] ]
							</div>
							[(#REM)ici, on peut ajouter un <br /> avec un style "clear:both;" conditionné au nb de colonnes]
						</BOUCLE_rmc_groupesparrubrique>
		
					[(#REM) pour affichage correct du #GET{bord} : ] 
						<br class="nettoyeur" />
				
					</div>
				</fieldset>
<script type="text/javascript"><!--
	$('#bouton_list_mots')  
	.click(function() {
            $('#list_mc').slideToggle('normal');
            $('#go:hidden').show('slow');
	})
		$('#list_mc').hide();
// --></script>
				<fieldset class="options_mc">
					<legend id="bouton_options"><:rmc:options_recherche:></legend>
					<div id="list_options">
					<p>
						<label for="nbjour"[ (#ID_RUBRIQUE|?{ style="font-weight:normal;"})]><:rmc:articles_date:></label>
						<select id="nbjour" name="nbjour">
							<option value="0" selected="selected">- <:rmc:tous:></option>
							<option value="7">- 7 <:rmc:jours:></option>
							<option value="30">- 1 <:rmc:mois:></option>
							<option value="9O">- 3 <:rmc:mois:></option>
							<option value="365">- 12 <:rmc:mois:></option>
						</select>
					</p>
			
					[(#GET{idrub}|!={0}|?{<p><label for="onlyrub"[ (#ID_RUBRIQUE|?{ style="font-weight:normal;"})]><input type="checkbox" value="1" name="onlyrub" id="onlyrub" /><:rmc:limiter_recherche_rub:></label></p>,''})]
				
					<p>
						<label for="allword"[ (#ID_RUBRIQUE|?{ style="font-weight:normal;"})]>
						<input type="checkbox" value="1" id="allword" name="allword"[ (#CONFIG{Recherche multicritere/mots_tous}|=={oui}|?{checked,''})] /><:rmc:mots_tous_presents:></label>
					</p>	
					</div>
				</fieldset>
				<div id="go">
				<p>
					<input type="hidden" value="#GET{idrub}" name="rubnum" />
					<input type="submit" value="Envoyer" class="button_mc" />
					<input type="reset" name="annuler" value="Annuler" class="submit button_mc" />
				</p>
				</div>
			</form>
<script type="text/javascript"><!--
	$('#bouton_options')  
	.click(function() {
            $('#list_options').slideToggle('normal');
            $('#go:hidden').show('normal');
	})
		$('#list_options').hide();
		$('#go').hide();
// --></script>
[(#ID_RUBRIQUE|?{
		</dd>
	</dl>
</div>
	,
		</dd>
	</dl>
})]
</BOUCLE_principale>
