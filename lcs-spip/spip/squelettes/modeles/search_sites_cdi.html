[(#REM)
######################################################################
# RECHERCHE MULTI-CRITERES                                           #
#                                                                    #
# Auteurs : Dominique (Dom) Lepaisant                                #
# http://tispip.etab.ac-caen.fr/                                     #
#  - Fev 2008                                                        #
#                                                                    #
# Adaptation de la contrib de Paul Sanchez - www.Netdeveloppeur.com  #
#                                                                    #
# Ce programme est un logiciel libre distribue sous licence GNU/GPL. #
# Pour plus de details voir le fichier COPYING.txt                   #
######################################################################]
<?php
$url = parse_url($_SERVER['QUERY_STRING']);
$param = $url['path'];
$pos = 0;
$indice = 255;
echo $_POST['id_mot'];
echo $_POST['submit'];
if (isset($_POST['id_mot'])) {	
	$resultataffiche = "<h1>R&eacute;sultats de votre recherche : </h1>";
	$resultataffiche .= "Copier-coller cette url dans le champ ad-hoc : <br />";
	$resultataffiche .= "<input type='text' value='http://".$_SERVER['HTTP_HOST']."/spip/spip.php?page=lcs-sites&id_mot=".$_POST['idmot']."' onclick='this.selected=selected'>";
	$resultataffiche .= "http://".$_SERVER['HTTP_HOST']."/spip/spip.php?page=lcs-sites&id_mot=".$_POST['idmot'];
	$resultataffiche .= "</input>";
	
echo $resultataffiche;

}
?>

[(#REM) On recupere l'id rubrique et on lui attribue 0 s'il n'existe pas ]
<B_rmc_rubrique><BOUCLE_rmc_rubrique(RUBRIQUES){id_rubrique}> </BOUCLE_rmc_rubrique>
	#SET{idrub,#ID_RUBRIQUE}
</B_rmc_rubrique>
	#SET{idrub,0}
<//B_rmc_rubrique>

<BOUCLE_principale(SPIP_RMC_RUBS_GROUPES){id_rubrique=#GET{idrub}}{0,1}>


	[(#SET{taille,#CONFIG{Recherche multicritere/taillepol}})]
	[(#SET{coul,#CONFIG{Recherche multicritere/hexvalpol}})]
	[(#SET{bord,#CONFIG{Recherche multicritere/hexval}})]

	[(#GET{taille}|!={""}|?{#SET{taille, font-size:#GET{taille}}})]
	[(#GET{coul}|!={""}|?{#SET{coul, color:#GET{coul}}})]
	[(#GET{bord}|!={""}|?{#SET{bord, border:1px solid #GET{bord}}})]
<form action="spip.php?page=lcs-trouve-url" method="post" id="form_mc" name="form_mc" style="font-size:.8em">
	<input type="hidden" name="id_rubrique" value="#GET{idrub}" />
	<div class="multicriteres"[ style="color:(#GET{coul})"]>
		<h2>Rechercher une URL</h2>
	</div>
	<fieldset>
		<legend><:rmc:liste_mots:></legend>
	[(#REM)	
		<p><em><:rmc:aide_select_multi:></em></p>
	]
		<div class="liste_mc" style="[(#GET{coul});][(#GET{bord});][(#GET{taille});]">

			[(#REM) On recherche les groupes de mots attribues à la rubrique en cours ou au secteur]
			<BOUCLE_rmc_groupesparrubrique(GROUPES_MOTS spip_rmc_rubs_groupes){id_rubrique ?}{id_rubrique=#GET{idrub}}>
				<div> 
					<p>
					<label for="#TITRE">#TITRE</label>
					</p>
					[(#REM) On boucle sur les mots du groupe]
					<p class="check">
						<BOUCLE_mots(MOTS){id_groupe}{par titre}>
							[(#REM) on cherche si le mot est exclu]
							<B_mots_exclus><BOUCLE_mots_exclus(SPIP_RMC_MOTS_EXCLUS){id_rubrique=#GET{idrub}}{id_mot_exclu=#ID_MOT}>
							</BOUCLE_mots_exclus></B_mots_exclus>
							[(#REM) titre du mot]
							<input type="radio" name="id_mot" value="#_mots:ID_MOT" />#_mots:TITRE<br />
							<//B_mots_exclus>
						</BOUCLE_mots>
					</p>
				</div>
				[(#REM)ici, on peut ajouter un <br /> avec un style "clear:both;" conditionné au nb de colonnes]
			</BOUCLE_rmc_groupesparrubrique>
		
		[(#REM) pour affichage correct du #GET{bord} : ] 
				<br style="clear:both" />
				
		</div>
	</fieldset>
	[(#REM)
	<fieldset class="options_mc">
		<legend><:rmc:options_recherche:></legend>
		<p>
			<label for="nbjour"><:rmc:articles_date:></label>
			<select id="nbjour" name="nbjour">
				<option value="0" selected="selected">- <:rmc:tous:></option>
				<option value="7">- 7 <:rmc:jours:></option>
				<option value="30">- 1 <:rmc:mois:></option>
				<option value="9O">- 3 <:rmc:mois:></option>
				<option value="365">- 12 <:rmc:mois:></option>
			</select>
		</p>
		[(#GET{idrub}|!={0}|?{<p><label for="onlyrub"><:rmc:limiter_recherche_rub:><input type="checkbox" value="1" name="onlyrub" id="onlyrub" /></label></p>,''})]
	]
				
		<p>
			<label for="allword" style="font-size:.9em"><:rmc:mots_tous_presents_sites:>
			<input type="checkbox" value="1" id="allword" name="allword"[ (#CONFIG{Recherche multicritere/mots_tous}|=={oui}|?{checked,''})] /></label>
		</p>	
	</fieldset>
	<p>
		<input type="hidden" value="#GET{idrub}" name="rubnum" />
		<input type="submit" value="Envoyer" class="button_mc" />
		<input type="reset" name="annuler" value="Annuler" class="submit button_mc" />
	</p>
</form>
</BOUCLE_principale>
